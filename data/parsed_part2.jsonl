{"id": "2e3f27ab49", "source_url": "https://documentation.ubuntu.com/server/how-to/graphics/gpu-virtualization-with-qemu-kvm/", "title": "GPU virtualisation with QEMU/KVM - Ubuntu Server documentation", "text": "GPU virtualisation with QEMU/KVM - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nGPU virtualisation with QEMU/KVM\n¶\nGraphics\n¶\nGraphics for QEMU/KVM always comes in two pieces: a\nfrontend\nand a backend.\nfrontend\n: Controlled via the\n-vga\nargument, which is provided to the guest. Usually one of\ncirrus\n,\nstd\n,\nqxl\n, or\nvirtio\n. The default these days is\nqxl\nwhich strikes a good balance between guest compatibility and performance. The guest needs a driver for whichever option is selected – this is the most common reason to not use the default (e.g., on very old Windows versions).\nbackend\n: Controlled via the\n-display\nargument. This is what the host uses to actually display the graphical content, which can be an application window via\ngtk\nor a\nvnc\n.\nIn addition, one can enable the\n-spice\nback end (which can be done in addition to\nvnc\n). This can be faster and provides more authentication methods than\nvnc\n.\nIf you want no graphical output at all, you can save some memory and CPU cycles by setting\n-nographic\n.\nIf you run with\nspice\nor\nvnc\nyou can use native\nvnc\ntools or virtualization-focused tools like\nvirt-viewer\n. You can read more about these in the\nlibvirt section\n.\nAll these options  are considered basic usage of graphics, but there are also advanced options for more specific use-cases. Those cases usually differ in their\nease-of-use and capability\n, such as:\nNeed 3D acceleration\n: Use\n-vga\nvirtio\nwith a local display having a\nGL\ncontext\n-display\ngtk,gl=on\n. This will use\nvirgil3d\non the host, and guest drivers are needed (which are common in Linux since\nKernels >= 4.4\nbut can be hard to come by for other cases). While not as fast as the next two options, the major benefit is that it can be used without additional hardware and without a proper input-output memory management unit (IOMMU)\nset up for device passthrough\n.\nNeed native performance\n: Use PCI passthrough of additional\nGPUs\nin the system. You’ll need an\nIOMMU\nset up, and you’ll need to unbind the cards from the host before you can pass it through, like so:\n-device\nvfio-pci,host\n=\n05\n:00.0,bus\n=\n1\n,addr\n=\n00\n.0,multifunction\n=\non,x-vga\n=\non\n-device\nvfio-pci,host\n=\n05\n:00.1,bus\n=\n1\n,addr\n=\n00\n.1\nNeed native performance, but multiple guests per card\n: Like with PCI passthrough, but using mediated devices to shard a card on the host into multiple devices, then passing those:\n-display\ngtk,gl\n=\non\n-device\nvfio-pci,sysfsdev\n=\n/sys/bus/pci/devices/0000:00:02.0/4dd511f6-ec08-11e8-b839-2f163ddee3b3,display\n=\non,rombar\n=\n0\nYou can read more\nabout vGPU at kraxel\nand\nUbuntu GPU mdev evaluation\n. The sharding of the cards is driver-specific and therefore will differ per manufacturer –\nIntel\n,\nNvidia\n, or\nAMD\n.\nThe advanced cases in particular can get pretty complex – it is recommended to use QEMU through\nlibvirt section\nfor those cases. libvirt will take care of all but the host kernel/BIOS tasks of such configurations. Below are the common basic actions needed for faster options (i.e., passthrough and mediated devices passthrough).\nThe initial step for both options is the same; you want to ensure your system has its IOMMU enabled and the device to pass should be in a group of its own. Enabling the VT-d and IOMMU is usually a BIOS action and thereby manufacturer dependent.\nPreparing the input-output memory management unit (IOMMU)\n¶\nOn the kernel side, there are various\noptions you can enable/configure\nfor the\nIOMMU feature\n. In recent Ubuntu kernels (>=5.4 => Focal or Bionic-HWE kernels) everything usually works by default, unless your hardware setup makes you need any of those tuning options.\nNote\nThe card used in all examples below e.g. when filtering for or assigning PCI IDs, is an NVIDIA V100 on PCI ID 41.00.0\n$\nlspci\n|\ngrep\n3D\n41\n:00.0\n3D\ncontroller:\nNVIDIA\nCorporation\nGV100GL\n[\nTesla\nV100\nPCIe\n16GB\n]\n(\nrev\na1\n)\nYou can check your boot-up kernel messages for IOMMU/\nDMAR\nmessages or even filter it for a particular PCI ID.\nTo list all:\ndmesg\n|\ngrep\n-i\n-e\nDMAR\n-e\nIOMMU\nWhich produces an output like this:\n[    3.509232] iommu: Default domain type: Translated\n...\n[    4.516995] pci 0000:00:01.0: Adding to iommu group 0\n...\n[    4.702729] perf/amd_iommu: Detected AMD IOMMU #0 (2 banks, 4 counters/bank).\nTo filter for the installed 3D card:\ndmesg\n|\ngrep\n-i\n-e\nDMAR\n-e\nIOMMU\n|\ngrep\n$(\nlspci\n|\nawk\n'/ 3D / {print $1}'\n)\nWhich shows the following output:\n[    4.598150] pci 0000:41:00.0: Adding to iommu group 66\nIf you have a particular device and want to check for its group you can do that via\nsysfs\n. If you have multiple cards or want the full list you can traverse the same\nsysfs\npaths for that.\nFor example, to find the group for our example card:\nfind\n/sys/kernel/iommu_groups/\n-name\n\"*\n$(\nlspci\n|\nawk\n'/ 3D / {print $1}'\n)\n*\"\nWhich it tells us is found here:\n/sys/kernel/iommu_groups/66/devices/0000:41:00.0\nWe can also check if there are other devices in this group:\nll\n/\nsys\n/\nkernel\n/\niommu_groups\n/\n66\n/\ndevices\n/\nlrwxrwxrwx\n1\nroot\nroot\n0\nJan\n3\n06\n:\n57\n0000\n:\n41\n:\n00.0\n->\n../../../../\ndevices\n/\npci0000\n:\n40\n/\n0000\n:\n40\n:\n03.1\n/\n0000\n:\n41\n:\n00.0\n/\nAnother useful tool for this stage (although the details are beyond the scope of this article) can be\nvirsh\nnode*\n, especially\nvirsh\nnodedev-list\n--tree\nand\nvirsh\nnodedev-dumpxml\n<pcidev>\n.\nNote\nSome older or non-server boards tend to group devices in one IOMMU group, which isn’t very useful as it means you’ll need to pass “all or none of them” to the same guest.\nPreparations for PCI and mediated devices pass-through – block host drivers\n¶\nFor both, you’ll want to ensure the normal driver isn’t loaded. In some cases you can do that at runtime via\nvirsh\nnodedev-detach\n<pcidevice>\n.\nlibvirt\nwill even do that automatically if, on the passthrough configuration, you have set\n<hostdev\nmode='subsystem'\ntype='pci'\nmanaged='yes'>\n.\nThis usually works fine for e.g. network cards, but some other devices like GPUs do not like to be unassigned, so there the required step usually is block loading the drivers you do not want to be loaded. In our GPU example the\nnouveau\ndriver would load and that has to be blocked. To do so you can create a\nmodprobe\nblacklist.\necho\n\"blacklist nouveau\"\n|\nsudo\ntee\n/etc/modprobe.d/blacklist-nouveau.conf\necho\n\"options nouveau modeset=0\"\n|\nsudo\ntee\n-a\n/etc/modprobe.d/blacklist-nouveau.conf\nsudo\nupdate-initramfs\n-u\nsudo\nreboot\nYou can check which kernel modules are loaded and available via\nlspci\n-v\n:\nlspci\n-v\n|\ngrep\n-A\n10\n\" 3D \"\nWhich in our example shows:\n41:00.0 3D controller: NVIDIA Corporation GV100GL [Tesla V100 PCIe 16GB] (rev a1)\n...\nKernel modules: nvidiafb, nouveau\nIf the configuration did not work instead it would show:\nKernel driver in use: nouveau\nPreparations for mediated devices pass-through - driver\n¶\nFor PCI passthrough, the above steps would be all the preparation needed, but for mediated devices one also needs to install and set up the host driver. The example here continues with our NVIDIA V100 which is\nsupported and available from Nvidia\n.\nThere is also an Nvidia document about the same steps available on\ninstallation and configuration of vGPU on Ubuntu\n.\nOnce you have the drivers from Nvidia, like\nnvidia-vgpu-ubuntu-470_470.68_amd64.deb\n, then install them and check (as above) that that driver is loaded. The one you need to see is\nnvidia_vgpu_vfio\n:\nlsmod\n|\ngrep\nnvidia\nWhich we can see in the output:\nnvidia_vgpu_vfio       53248  38\nnvidia              35282944  586 nvidia_vgpu_vfio\nmdev                   24576  2 vfio_mdev,nvidia_vgpu_vfio\ndrm                   491520  6 drm_kms_helper,drm_vram_helper,nvidia\nNote\nWhile it works without a vGPU manager, to get the full capabilities you’ll need to configure the\nvGPU manager (that came with above package)\nand a license server so that each guest can get a license for the vGPU provided to it. Please see\nNvidia’s documentation for the license server\n. While not officially supported on Linux (as of Q1 2022), it’s worthwhile to note that it runs fine on Ubuntu with\nsudo\napt\ninstall\nunzip\ndefault-jre\ntomcat9\nliblog4j2-java\nlibslf4j-java\nusing\n/var/lib/tomcat9\nas the server path in the license server installer.\nIt’s also worth mentioning that the Nvidia license server went\nEOL\non 31 July 2023\n. At that time, it was replaced by the\nNVIDIA License System\n.\nHere is an example of those when running fine:\n# general status\n$ systemctl status nvidia-vgpu-mgr\n     Loaded: loaded (/lib/systemd/system/nvidia-vgpu-mgr.service; enabled; vendor preset: enabled)\n     Active: active (running) since Tue 2021-09-14 07:30:19 UTC; 3min 58s ago\n    Process: 1559 ExecStart=/usr/bin/nvidia-vgpu-mgr (code=exited, status=0/SUCCESS)\n   Main PID: 1564 (nvidia-vgpu-mgr)\n      Tasks: 1 (limit: 309020)\n     Memory: 1.1M\n     CGroup: /system.slice/nvidia-vgpu-mgr.service\n             └─1564 /usr/bin/nvidia-vgpu-mgr\n\nSep 14 07:30:19 node-watt systemd[1]: Starting NVIDIA vGPU Manager Daemon...\nSep 14 07:30:19 node-watt systemd[1]: Started NVIDIA vGPU Manager Daemon.\nSep 14 07:30:20 node-watt nvidia-vgpu-mgr[1564]: notice: vmiop_env_log: nvidia-vgpu-mgr daemon started\n\n# Entries when a guest gets a vGPU passed\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: (0x0): gpu-pci-id : 0x4100\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: (0x0): vgpu_type : Quadro\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: (0x0): Framebuffer: 0x1dc000000\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: (0x0): Virtual Device Id: 0x1db4:0x1252\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: (0x0): FRL Value: 60 FPS\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: ######## vGPU Manager Information: ########\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: Driver Version: 470.68\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: (0x0): vGPU supported range: (0x70001, 0xb0001)\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: (0x0): Init frame copy engine: syncing...\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: (0x0): vGPU migration enabled\nSep 14 08:29:50 node-watt nvidia-vgpu-mgr[2866]: notice: vmiop_log: display_init inst: 0 successful\n\n# Entries when a guest grabs a license\nSep 15 06:55:50 node-watt nvidia-vgpu-mgr[4260]: notice: vmiop_log: (0x0): vGPU license state: Unlicensed (Unrestricted)\nSep 15 06:55:52 node-watt nvidia-vgpu-mgr[4260]: notice: vmiop_log: (0x0): vGPU license state: Licensed\n\n# In the guest the card is then fully recognized and enabled\n$ nvidia-smi -a | grep -A 2 \"Licensed Product\"\n    vGPU Software Licensed Product\n        Product Name                      : NVIDIA RTX Virtual Workstation\n        License Status                    : Licensed\nA\nmediated device\nis essentially the partitioning of a hardware device using\nfirmware\nand host driver features. This brings a lot of flexibility and options; in our example we can split our 16G GPU into 2x8G, 4x4G, 8x2G or 16x1G just as we need it. The following gives an example of how to split it into two 8G cards for a compute profile and pass those to guests.\nPlease refer to the\nNVIDIA documentation\nfor advanced tunings and different card profiles.\nThe tool for listing and configuring these mediated devices is\nmdevctl\n:\nsudo\nmdevctl\ntypes\nWhich will list the available types:\n...\n  nvidia-300\n    Available instances: 0\n    Device API: vfio-pci\n    Name: GRID V100-8C\n    Description: num_heads=1, frl_config=60, framebuffer=8192M, max_resolution=4096x2160, max_instance=2\nKnowing the PCI ID (\n0000:41:00.0\n) and the mediated device type we want (\nnvidia-300\n) we can now create those mediated devices:\n$ sudo mdevctl define --parent 0000:41:00.0 --type nvidia-300\nbc127e23-aaaa-4d06-a7aa-88db2dd538e0\n$ sudo mdevctl define --parent 0000:41:00.0 --type nvidia-300\n1360ce4b-2ed2-4f63-abb6-8cdb92100085\n$ sudo mdevctl start --parent 0000:41:00.0 --uuid bc127e23-aaaa-4d06-a7aa-88db2dd538e0\n$ sudo mdevctl start --parent 0000:41:00.0 --uuid 1360ce4b-2ed2-4f63-abb6-8cdb92100085\nAfter that, you can check the UUID of your ready mediated devices:\n$ sudo mdevctl list -d\nbc127e23-aaaa-4d06-a7aa-88db2dd538e0 0000:41:00.0 nvidia-108 manual (active)\n1360ce4b-2ed2-4f63-abb6-8cdb92100085 0000:41:00.0 nvidia-108 manual (active)\nThose UUIDs can then be used to pass the mediated devices to the guest - which from here is rather similar to the pass through of a full PCI device.\nPassing through PCI or mediated devices\n¶\nAfter the above setup is ready one can pass through those devices, in\nlibvirt\nfor a PCI passthrough that looks like:\n<\nhostdev\nmode\n=\n'subsystem'\ntype\n=\n'pci'\nmanaged\n=\n'yes'\n>\n<\nsource\n>\n<\naddress\ndomain\n=\n'0x0000'\nbus\n=\n'0x41'\nslot\n=\n'0x00'\nfunction\n=\n'0x0'\n/>\n</\nsource\n>\n</\nhostdev\n>\nAnd for mediated devices it is quite similar, but using the UUID.\n<\nhostdev\nmode\n=\n'subsystem'\ntype\n=\n'mdev'\nmanaged\n=\n'no'\nmodel\n=\n'vfio-pci'\ndisplay\n=\n'on'\n>\n<\nsource\n>\n<\naddress\nuuid\n=\n'634fc146-50a3-4960-ac30-f09e5cedc674'\n/>\n</\nsource\n>\n</\nhostdev\n>\nThose sections can be\npart of the guest definition\nitself, to be added on guest startup and freed on guest shutdown. Or they can be in a file and used by for hot-add remove if the hardware device and its drivers support it\nvirsh\nattach-device\n.\nNote\nThis works great on Focal, but\ntype='none'\nas well as\ndisplay='off'\nweren’t available on Bionic. If this level of control is required one would need to consider using the\nUbuntu Cloud Archive\nor\nServer-Backports\nfor a newer stack of the virtualisation components.\nAnd finally, it might be worth noting that while mediated devices are becoming more common and known for vGPU handling, they are a general infrastructure also used (for example) for\ns390x vfio-ccw\n.", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:17Z", "original_len_words": 2186}}
{"id": "d62c14a545", "source_url": "https://documentation.ubuntu.com/server/how-to/graphics/install-nvidia-drivers/", "title": "NVIDIA drivers installation - Ubuntu Server documentation", "text": "NVIDIA drivers installation - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nNVIDIA drivers installation\n¶\nThis page shows how to install the NVIDIA drivers from the command line, using either the\nubuntu-drivers\ntool (recommended), or APT.\nNVIDIA drivers releases\n¶\nWe package two types of NVIDIA drivers:\nUnified Driver Architecture (UDA)\ndrivers - which are recommended for the generic desktop use, and which you can also find\non the NVIDIA website\n.\nEnterprise Ready Drivers\n(\nERD\n) - which are recommended on servers and for computing tasks. Their packages can be recognized by the\n-server\nsuffix. You can read more about these drivers\nin the NVIDIA documentation\n.\nAdditionally, we package the\nNVIDIA Fabric Manager\nand the\nNVIDIA Switch Configuration and Query (NSCQ) Library\n, which you will only need if you have NVswitch hardware. The Fabric Manager and NSCQ library are only available with the ERDs or\n-server\ndriver versions.\nCheck driver versions\n¶\nTo check the version of your currently running driver:\ncat\n/proc/driver/nvidia/version\nThe recommended way (ubuntu-drivers tool)\n¶\nThe\nubuntu-drivers\ntool relies on the same logic as the “Additional Drivers” graphical tool, and allows more flexibility on desktops and on servers.\nThe\nubuntu-drivers\ntool is recommended if your computer uses Secure Boot, since it always tries to install signed drivers which are known to work with Secure Boot.\nCheck the available drivers for your hardware\n¶\nFor desktop:\nsudo\nubuntu-drivers\nlist\nor, for servers:\nsudo\nubuntu-drivers\nlist\n--gpgpu\nYou should see a list such as the following:\nnvidia-driver-470\nnvidia-driver-470-server\nnvidia-driver-535\nnvidia-driver-535-open\nnvidia-driver-535-server\nnvidia-driver-535-server-open\nnvidia-driver-550\nnvidia-driver-550-open\nnvidia-driver-550-server\nnvidia-driver-550-server-open\nInstalling the drivers for generic use (e.g. desktop and gaming)\n¶\nYou can either rely on automatic detection, which will install the driver that is considered the best match for your hardware:\nsudo\nubuntu-drivers\ninstall\nOr you can tell the\nubuntu-drivers\ntool which driver you would like installed. If this is the case, you will have to use the driver version (such as\n535\n) that you saw when you used the\nubuntu-drivers\nlist\ncommand.\nLet’s assume we want to install the\n535\ndriver:\nsudo\nubuntu-drivers\ninstall\nnvidia:535\nInstalling the drivers on servers and/or for computing purposes\n¶\nYou can either rely on automatic detection, which will install the driver that is considered the best match for your hardware:\nsudo\nubuntu-drivers\ninstall\n--gpgpu\nOr you can tell the\nubuntu-drivers\ntool which driver you would like installed. If this is the case, you will have to use the driver version (such as\n535\n) and the\n-server\nsuffix that you saw when you used the\nubuntu-drivers\nlist\n--gpgpu\ncommand.\nLet’s assume we want to install the\n535-server\ndriver (listed as\nnvidia-driver-535-server\n):\nsudo\nubuntu-drivers\ninstall\n--gpgpu\nnvidia:535-server\nYou will also want to install the following additional components:\nsudo\napt\ninstall\nnvidia-utils-535-server\nOptional step\n¶\nIf your system comes with NVswitch hardware, then you will want to install Fabric Manager and the NVSwitch Configuration and Query library. You can do so by running the following:\nsudo\napt\ninstall\nnvidia-fabricmanager-535\nlibnvidia-nscq-535\nNote\nWhile\nnvidia-fabricmanager\nand\nlibnvidia-nscq\ndo not have the same\n-server\nlabel in their name, they are really meant to match the\n-server\ndrivers in the Ubuntu archive. For example,\nnvidia-fabricmanager-535\nwill match the\nnvidia-driver-535-server\npackage version (not the\nnvidia-driver-535\npackage\n).\nManual driver installation (using APT)\n¶\nInstalling the NVIDIA driver manually means installing the correct kernel modules first, then installing the metapackage for the driver series.\nInstalling the kernel modules\n¶\nIf your system uses Secure Boot (as most x86 modern systems do), your kernel will require the kernel modules to be signed. There are two (mutually exclusive) ways to achieve this.\nInstalling the pre-compiled NVIDIA modules for your kernel\n¶\nInstall the metapackage for your kernel flavour (e.g.\ngeneric\n,\nlowlatency\n, etc) which is specific to the driver branch (e.g.\n535\n) that you want to install, and whether you want the compute vs. general display driver (e.g.\n-server\nor not):\nsudo\napt\ninstall\nlinux-modules-nvidia-\n${\nDRIVER_BRANCH\n}${\nSERVER\n}\n-\n${\nLINUX_FLAVOUR\n}\n(e.g.\nlinux-modules-nvidia-535-generic\n)\nCheck that the modules for your specific kernel/\nABI\nwere installed by the metapackage:\nsudo\napt-cache\npolicy\nlinux-modules-nvidia-\n${\nDRIVER_BRANCH\n}${\nSERVER\n}\n-\n$(\nuname\n-r\n)\n(e.g.\nsudo\napt-cache\npolicy\nlinux-modules-nvidia-535-$(uname\n-r)\n)\nIf the modules were not installed for your current running kernel, upgrade to the latest kernel or install them by specifying the running kernel version:\nsudo\napt\ninstall\nlinux-modules-nvidia-\n${\nDRIVER_BRANCH\n}${\nSERVER\n}\n-\n$(\nuname\n-r\n)\n(e.g.\nsudo\napt\ninstall\nlinux-modules-nvidia-535-$(uname\n-r)\n)\nBuilding your own kernel modules using the NVIDIA DKMS package\n¶\nInstall the relevant NVIDIA\nDKMS\npackage and\nlinux-headers\nto build the kernel modules, and enroll your own key to sign the modules.\nInstall the\nlinux-headers\nmetapackage for your kernel flavour (e.g.\ngeneric\n,\nlowlatency\n, etc):\nsudo\napt\ninstall\nlinux-headers-\n${\nLINUX_FLAVOUR\n}\nCheck that the headers for your specific kernel were installed by the metapackage:\nsudo\napt-cache\npolicy\nlinux-headers-\n$(\nuname\n-r\n)\nIf the headers for your current running kernel were not installed, install them by specifying the running kernel version:\nsudo\napt\ninstall\nlinux-headers-\n$(\nuname\n-r\n)\nFinally, install the NVIDIA DKMS package for your desired driver series (this may automatically guide you through creating and enrolling a new key for Secure Boot):\nsudo\napt\ninstall\nnvidia-dkms-\n${\nDRIVER_BRANCH\n}${\nSERVER\n}\nInstalling the user-space drivers and the driver libraries\n¶\nAfter installing the correct kernel modules (see the relevant section of this document), install the correct driver metapackage:\nsudo\napt\ninstall\nnvidia-driver-\n${\nDRIVER_BRANCH\n}${\nSERVER\n}\n(Optional) Installing Fabric Manager and the NSCQ library\n¶\nIf your system comes with NVswitch hardware, then you will want to install Fabric Manager and the NVSwitch Configuration and Query library. You can do so by running the following:\nsudo\napt\ninstall\nnvidia-fabricmanager-\n${\nDRIVER_BRANCH\n}\nlibnvidia-nscq-\n${\nDRIVER_BRANCH\n}\nNote\nWhile\nnvidia-fabricmanager\nand\nlibnvidia-nscq\ndo not have the same\n-server\nlabel in their name, they are really meant to match the\n-server\ndrivers in the Ubuntu archive. For example,\nnvidia-fabricmanager-535\nwill match the\nnvidia-driver-535-server\npackage version (not the\nnvidia-driver-535\npackage).\nSwitching between pre-compiled and DKMS modules\n¶\nUninstalling the NVIDIA drivers (below)\nManual driver installation using APT\nUninstalling the NVIDIA drivers\n¶\nRemove any NVIDIA packages from your system:\nsudo\napt\n--purge\nremove\n'*nvidia*${DRIVER_BRANCH}*'\nIf you are unsure which\n${DRIVER_BRANCH}\nto pick for removal you might look at the installed nvidia packages and see the different\n${DRIVER_BRANCH}\nnumbers that are present on your system.\nSince\nautoremove\nwill take care of all indirect dependencies it is sufficient to list those that have been directly installed by using\napt-mark\n.\napt-mark\nshowmanual\n|\ngrep\nnvidia\n`\n.\nRemove any additional packages that may have been installed as a dependency (e.g. the\ni386\nlibraries on amd64 systems) and which were not caught by the previous command:\nsudo\napt\nautoremove\nTransitional packages to new driver branches\n¶\nWhen NVIDIA stops support on a driver branch, then Canonical will transition you to the next supported driver branch automatically if you try to install that driver branch.\nSee NVIDIA’s\ncurrent support matrix\nin their documentation.\nTroubleshooting\n¶\nDriver/library version mismatch error\n¶\nIf you encounter the following error when running the\nnvidia-smi\ncommand:\nFailed to initialize NVML: Driver/library version mismatch\nThis typically indicates that the userspace driver packages were upgraded while the kernel module is still on the older version (for example, the client reports one driver version while the kernel module reports another). This situation often occurs after a system upgrade. To verify this, check the kernel logs:\nsudo dmesg\nLook for error messages similar to:\nNVRM: API mismatch: the client has the version 570.172.08, but\nNVRM: this kernel module has the version 570.158.01.  Please\nNVRM: make sure that this kernel module and all NVIDIA driver\nNVRM: components have the same version.\nSolution\n: Rebooting the system will load the updated kernel module and bring the versions back in sync.\nNo devices were found error\n¶\nIf you encounter the following error when running the\nnvidia-smi\ncommand:\nNo devices were found\nThis may occur if the open-source NVIDIA kernel driver\nnouveau\nis pre-installed and loaded, which conflicts with the proprietary NVIDIA driver. To check whether nouveau is loaded:\nlsmod | grep nouveau\nSolution\n: If nouveau kernel module is loaded, blacklist it and rebuild the initramfs:\necho \"blacklist nouveau\" | sudo tee /etc/modprobe.d/disable-nouveau.conf\necho \"options nouveau modeset=0\" | sudo tee -a /etc/modprobe.d/disable-nouveau.conf\nsudo rmmod nouveau || true\nsudo update-initramfs -u\nThen reboot the system for the changes to take effect.", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:17Z", "original_len_words": 1443}}
{"id": "63a70fc702", "source_url": "https://documentation.ubuntu.com/server/how-to/high-availability/", "title": "High availability - Ubuntu Server documentation", "text": "High availability - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nHigh availability\n¶\nDistributed Replicated Block Device (DRBD) mirrors block devices between multiple hosts. This guide shows how to install and configure a DRBD.\nInstall a Distributed Replicated Block Device\nSee also\n¶\nExplanation:\nHigh Availability\nReference:\nHigh availability", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:17Z", "original_len_words": 71}}
{"id": "58b4aad1bf", "source_url": "https://documentation.ubuntu.com/server/how-to/high-availability/install-drbd/", "title": "Distributed Replicated Block Device (DRBD) - Ubuntu Server documentation", "text": "Distributed Replicated Block Device (DRBD) - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nDistributed Replicated Block Device (DRBD)\n¶\nDistributed Replicated Block Device (DRBD) mirrors block devices between multiple hosts. The replication is transparent to other applications on the host systems. Any block device hard disks, partitions, RAID devices, logical volumes, etc can be mirrored.\nInstall DRBD\n¶\nTo get started using DRBD, first install the necessary packages. In a terminal window, run the following command:\nsudo\napt\ninstall\ndrbd-utils\nNote\nIf you are using the\nvirtual kernel\nas part of a virtual machine you will need to manually compile the\ndrbd\nmodule. It may be easier to install the\nlinux-modules-extra-$(uname\n-r)\npackage inside the virtual machine.\nConfigure DRBD\n¶\nThis section covers setting up a DRBD to replicate a separate\n/srv\npartition, with an\next3\nfilesystem\nbetween two hosts. The partition size is not particularly relevant, but both partitions need to be the same size.\nThe two hosts in this example will be called\ndrbd01\nand\ndrbd02\n. They will need to have name resolution configured either through\nDNS\nor the\n/etc/hosts\nfile. See our\nguide to DNS\nfor details.\nOn the first host, edit\n/etc/drbd.conf\nas follows:\nglobal\n{\nusage\n-\ncount\nno\n;\n}\ncommon\n{\nsyncer\n{\nrate\n100\nM\n;\n}\n}\nresource\nr0\n{\nprotocol\nC\n;\nstartup\n{\nwfc\n-\ntimeout\n15\n;\ndegr\n-\nwfc\n-\ntimeout\n60\n;\n}\nnet\n{\ncram\n-\nhmac\n-\nalg\nsha1\n;\nshared\n-\nsecret\n\"secret\"\n;\n}\non\ndrbd01\n{\ndevice\n/\ndev\n/\ndrbd0\n;\ndisk\n/\ndev\n/\nsdb1\n;\naddress\n192.168.0.1\n:\n7788\n;\nmeta\n-\ndisk\ninternal\n;\n}\non\ndrbd02\n{\ndevice\n/\ndev\n/\ndrbd0\n;\ndisk\n/\ndev\n/\nsdb1\n;\naddress\n192.168.0.2\n:\n7788\n;\nmeta\n-\ndisk\ninternal\n;\n}\n}\nNote\nThere are many other options in\n/etc/drbd.conf\n, but for this example the default values are enough.\nNow copy\n/etc/drbd.conf\nto the second host:\nscp\n/etc/drbd.conf\ndrbd02:~\nAnd, on\ndrbd02\n, move the file to\n/etc\n:\nsudo\nmv\ndrbd.conf\n/etc/\nNow using the\ndrbdadm\nutility, initialize the meta data storage. On both servers, run:\nsudo\ndrbdadm\ncreate-md\nr0\nNext, on both hosts, start the\ndrbd\ndaemon:\nsudo\nsystemctl\nstart\ndrbd.service\nOn\ndrbd01\n(or whichever host you wish to be the primary), enter the following:\nsudo\ndrbdadm\n--\n--overwrite-data-of-peer\nprimary\nall\nAfter running the above command, the data will start syncing with the secondary host. To watch the progress, on\ndrbd02\nenter the following:\nwatch\n-n1\ncat\n/proc/drbd\nTo stop watching the output press\nCtrl\n+\nC\n.\nFinally, add a filesystem to\n/dev/drbd0\nand mount it:\nsudo\nmkfs.ext3\n/dev/drbd0\nsudo\nmount\n/dev/drbd0\n/srv\nTesting\n¶\nTo test that the data is actually syncing between the hosts copy some files on\ndrbd01\n, the primary, to\n/srv\n:\nsudo\ncp\n-r\n/etc/default\n/srv\nNext, unmount\n/srv\n:\nsudo\numount\n/srv\nNow demote the\nprimary\nserver to the\nsecondary\nrole:\nsudo\ndrbdadm\nsecondary\nr0\nNow on the\nsecondary\nserver, promote it to the\nprimary\nrole:\nsudo\ndrbdadm\nprimary\nr0\nLastly, mount the partition:\nsudo\nmount\n/dev/drbd0\n/srv\nUsing\nls\nyou should see\n/srv/default\ncopied from the former primary host\ndrbd01\n.\nFurther reading\n¶\nFor more information on DRBD see the\nDRBD web site\n.\nThe\ndrbd.conf(5)\nmanual page contains details on the options not covered in this guide.\nAlso, see the\ndrbdadm(8)\nmanpage.", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:17Z", "original_len_words": 592}}
{"id": "a24f77d276", "source_url": "https://documentation.ubuntu.com/server/how-to/installation/", "title": "Server installation - Ubuntu Server documentation", "text": "Server installation - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nServer installation\n¶\nIf you are new to Ubuntu, we recommend our\nbasic installation\ntutorial to get you started.\nAutomatic install\n¶\nThe Ubuntu Installer has its own documentation for automatic (or “hands off”) installations. These guides from the Ubuntu Installer documentation are available for automatic installations.\nIntroduction to Automated Server installer\nAutoinstall quickstart\nAutoinstall quickstart on s390x\nAdvanced install\n¶\nThis list of guides contains installation instructions for architecture-specific and more advanced setups. Select your preferred architecture to see which guides are available.\namd64\nNetboot install\narm64\nNetboot install\nChoose between the arm64 and arm64+largemem installer options\nppc64el\nNetboot install\nVirtual CD-ROM and Petitboot install\ns390x\nInstall via z/VM\nNon-interactive IBM z/VM autoinstall\nInstall via LPAR\nNon-interactive IBM Z LPAR autoinstall\nSee also\n¶\nReference:\nSystem requirements", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:18Z", "original_len_words": 160}}
{"id": "1e3fce9955", "source_url": "https://documentation.ubuntu.com/server/how-to/mail-services/", "title": "Mail services - Ubuntu Server documentation", "text": "Mail services - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nMail services\n¶\nSending email from one person to another over a network or the Internet requires:\nThe sender’s email client (\nMail User Agent\n) sends the message.\nOne or more\nMail Transfer Agents\n(MTA) to transfer the message.\nThe final MTA sends the message to a\nMail Delivery Agent\n(MDA) for delivery to the recipient’s inbox.\nFinally, the recipient’s email client retrieves the message, usually via a\nPOP3\nor\nIMAP\nserver.\nThese systems must all be configured correctly to successfully deliver a message.\nMail User Agent\n¶\nThunderbird\nis the default Mail User Agent (email client) used by Ubuntu. It comes pre-installed on all Ubuntu machines from Ubuntu 16.04 LTS (Xenial) onwards.\nIf you need to install Thunderbird manually,\nthis short guide\nwill walk you through the steps.\nMail Transfer Agent\n¶\nOn Ubuntu,\nPostfix\nis the default supported MTA. It is compatible with the\nsendmail\nMTA.\nInstall Postfix\nexplains how to install and configure Postfix, including how to configure SMTP for secure communications.\nExim4\ncan be installed in place of sendmail, although its configuration is quite different.\nInstall Exim4\nexplains how to install and configure Exim4 on Ubuntu.\nMail Delivery Agent\n¶\nDovecot\nis an MDA written with security primarily in mind. It supports the\nmbox\nand\nMaildir\nmailbox formats.\nInstall Dovecot\nexplains how to set up Dovecot as an IMAP or POP3 server", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:18Z", "original_len_words": 259}}
{"id": "2372cd0da9", "source_url": "https://documentation.ubuntu.com/server/how-to/mail-services/install-dovecot/", "title": "Install and configure Dovecot - Ubuntu Server documentation", "text": "Install and configure Dovecot - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nInstall and configure Dovecot\n¶\nInstall Dovecot\n¶\nTo install a basic Dovecot server with common POP3 and IMAP functions, run the following command:\nsudo\napt\ninstall\ndovecot-imapd\ndovecot-pop3d\nThere are various other Dovecot modules including\ndovecot-sieve\n(mail filtering),\ndovecot-solr\n(full text search),\ndovecot-antispam\n(spam filter training),\ndovecot-ldap\n(user directory).\nConfigure Dovecot\n¶\nTo configure Dovecot, edit the file\n/etc/dovecot/dovecot.conf\nand its included config files in\n/etc/dovecot/conf.d/\n. By default, all installed protocols will be enabled via an\ninclude\ndirective in\n/etc/dovecot/dovecot.conf\n.\n!include_try /usr/share/dovecot/protocols.d/*.protocol\nIMAPS and POP3S are more secure because they use SSL encryption to connect. A basic self-signed SSL certificate is automatically set up by package\nssl-cert\nand used by Dovecot in\n/etc/dovecot/conf.d/10-ssl.conf\n.\nMbox\nformat is configured by default, but you can also use\nMaildir\nif required. More details can be found in the comments in\n/etc/dovecot/conf.d/10-mail.conf\n. Also see\nthe Dovecot web site\nto learn about further benefits and details.\nMake sure to also configure your chosen Mail Transport Agent (MTA) to transfer the incoming mail to the selected type of mailbox.\nRestart the Dovecot daemon\n¶\nOnce you have configured Dovecot, restart its daemon in order to test your setup using the following command:\nsudo\nservice\ndovecot\nrestart\nTry to log in with the commands\ntelnet\nlocalhost\npop3\n(for POP3) or\ntelnet\nlocalhost\nimap2\n(for IMAP).  You should see something like the following:\nbhuvan@rainbow:~$ telnet localhost pop3\nTrying 127.0.0.1...\nConnected to localhost.localdomain.\nEscape character is '^]'.\n+OK Dovecot ready.\nDovecot SSL configuration\n¶\nBy default, Dovecot is configured to use SSL automatically using the package\nssl-cert\nwhich provides a self signed certificate.\nYou can instead generate your own custom certificate for Dovecot using\nopenssh\n, for example:\nsudo\nopenssl\nreq\n-new\n-x509\n-days\n1000\n-nodes\n-out\n\"/etc/dovecot/dovecot.pem\"\n\\\n-keyout\n\"/etc/dovecot/private/dovecot.pem\"\nNext, edit\n/etc/dovecot/conf.d/10-ssl.conf\nand amend following lines to specify that Dovecot should use these custom certificates :\nssl_cert = </etc/dovecot/private/dovecot.pem\nssl_key = </etc/dovecot/private/dovecot.key\nYou can get the SSL certificate from a Certificate Issuing Authority or you can create self-signed one. Once you create the certificate, you will have a key file and a certificate file that you want to make known in the config shown above.\nSee also\nFor more details on creating custom certificates, see our guide on\nsecurity certificates\n.\nConfigure a firewall for an email server\n¶\nTo access your mail server from another computer, you must configure your firewall to allow connections to the server on the necessary ports.\nIMAP - 143\nIMAPS - 993\nPOP3 - 110\nPOP3S - 995\nFurther reading\n¶\nThe\nDovecot website\nhas more general information about Dovecot.\nThe\nDovecot manual\nprovides full documentation for Dovecot use.\nThe\nDovecot Ubuntu Wiki\npage has more details on configuration.", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:18Z", "original_len_words": 486}}
{"id": "d6c36af75a", "source_url": "https://documentation.ubuntu.com/server/how-to/mail-services/install-exim4/", "title": "Install and configure Exim4 - Ubuntu Server documentation", "text": "Install and configure Exim4 - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nInstall and configure Exim4\n¶\nInstall Exim4\n¶\nTo install\nExim4\n, run the following command:\nsudo\napt\ninstall\nexim4\nConfigure Exim4\n¶\nTo configure Exim4, run the following command:\nsudo\ndpkg-reconfigure\nexim4-config\nThis displays a “wizard” user interface for configuring the software. One important question in this configuration is whether Exim4 should split the configuration over multiple files, or use a single configuration file.\nNote\nThe default configuration layout for Exim4 is the single configuration file one.\nIf using multiple configuration files, then the configuration will be split in a directory structure under\n/etc/exim4/conf.d\n, like so:\n/etc/exim4/\n└── conf.d\n    ├── acl\n    ├── auth\n    ├── main\n    ├── retry\n    ├── rewrite\n    ├── router\n    └── transport\nEach subdirectory contains one or more individual configuration files.\nIf, however, Exim4 was set up to use a single configuration file, then that file will be\n/etc/exim4/exim4.conf.template\n. It will essentially be as if all individual configuration files from the previous layout were concatenated into one file.\nIn any of these scenarios, after making a change to the configuration, the following command must be executed to update the actual configuration file that Exim4 will use:\nsudo update-exim4.conf\nThe\nupdate-exim4.conf\ncommand will update the autogenerated configuration file stored in\n/var/lib/exim4/config.autogenerated\n. This is the actual configuration file that Exim4 uses.\nWarning\nYou should never manually edit the configuration file\n/var/lib/exim4/config.autogenerated\n, because it is updated automatically every time you run\nupdate-exim4.conf\n. Any changes you make to it will eventually be lost.\nIf configuration changes were made, the service should also be restarted:\nsudo systemctl restart exim4\nAll the choices made via\ndpkg-reconfigure\nexim4-config\nare stored in the\n/etc/exim4/update-exim4.conf.conf\nfile. To re-configure the software you can either re-run\ndpkg-reconfigure\nas before, or manually edit this file using your preferred editor.\nStart the Exim4 daemon\n¶\nThe following command will start the Exim4 daemon:\nsudo\nservice\nexim4\nstart\nSMTP authentication\n¶\nThere are multiple authentication options available for Exim4. Here we will document two methods:\nAuthenticate Linux users present in the local shadow file (\n/etc/shadow\n), via\nsaslauthd\nand PAM.\nAuthenticate arbitrary users against a custom Exim4 password database (\n/etc/exim4/passwd\n).\nBoth of these methods use clear text passwords transmitted over the network, so they need to be protected by Transport Layer Security (TLS).\nWarning\nAll configuration steps shown from now on will assume a split-configuration mode for Exim4. If you have selected the non-split mode, then all commands that edit a configuration file under\n/etc/exim4/conf.d\nin the sections below should be replaced with editing the single file\n/etc/exim4/exim4.conf.template\n.\nEnabling TLS\n¶\nFirst, enter the following into a terminal prompt to create a certificate for use with TLS:\nsudo\n/usr/share/doc/exim4-base/examples/exim-gencert\nThis command will ask some questions about the certificate, like country, city, and others. The most important one, and that must be correct otherwise TLS won’t work for this server, is the “Server name” one. It\nMUST\nmatch the fully qualified hostname (FQDN) of the system where Exim4 is deployed.\nWarning\nThis will install a self-signed certificate. If deploying this system in production, you must get a proper certificate signed by a recognized Certificate Authority (CA), or, if using an internal, you will have to distribute the CA to all clients expected to connect to this server.\nConfigure Exim4 for TLS by editing the\n/etc/exim4/conf.d/main/03_exim4-config_tlsoptions\nfile and adding the following:\nMAIN_TLS_ENABLE = yes\nAuthenticating existing Linux users\n¶\nTo authenticate existing Linux users, that is, users who already have accounts on this system, we will use the\nsaslauthd\nservice.\nNote\nTo manage local Linux users, please refer to\nUser management\n.\nConfigure Exim4 to use the\nsaslauthd\ndaemon for authentication by editing\n/etc/exim4/conf.d/auth/30_exim4-config_examples\n– uncomment the\nplain_saslauthd_server\nand\nlogin_saslauthd_server\nsections:\nplain_saslauthd_server:\n  driver = plaintext\n  public_name = PLAIN\n  server_condition = ${if saslauthd{{$auth2}{$auth3}}{1}{0}}\n  server_set_id = $auth2\n  server_prompts = :\n  .ifndef AUTH_SERVER_ALLOW_NOTLS_PASSWORDS\n  server_advertise_condition = ${if eq{$tls_cipher}{}{}{*}}\n  .endif\n\nlogin_saslauthd_server:\n  driver = plaintext\n  public_name = LOGIN\n  server_prompts = \"Username:: : Password::\"\n  # don't send system passwords over unencrypted connections\n  server_condition = ${if saslauthd{{$auth1}{$auth2}}{1}{0}}\n  server_set_id = $auth1\n  .ifndef AUTH_SERVER_ALLOW_NOTLS_PASSWORDS\n  server_advertise_condition = ${if eq{$tls_cipher}{}{}{*}}\n  .endif\nThis enables the\nPLAIN\nand\nLOGIN\nauthentication mechanisms via\nsaslauthd\n.\nFor Ubuntu 22.04 and earlier, of it you plan to use authentication mechanisms that will need read access to\n/etc/sasldb2\n(not covered in this guide), you need to add the\nDebian-exim\nuser to the\nsasl\ngroup:\nsudo gpasswd -a Debian-exim sasl\nTo make all these changes effective, the main configuration file needs to be updated, and Exim4 restarted:\nsudo update-exim4.conf\nsudo systemctl restart exim4\nThis concludes the Exim4 side of the configuration. Next, the\nsasl2-bin\npackage needs to be installed:\nsudo apt install sasl2-bin\nThe main configuration for\nsaslauthd\nis in the\n/etc/default/saslauthd\nfile. What needs to be verified is the\nMECHANISMS\nsetting, which we want to be\nPAM\n:\nMECHANISMS\n=\n\"pam\"\nNote\nIn Ubuntu 22.04 Jammy and earlier, we also need to add\nSTART=\"yes\"\nto\n/etc/default/saslauthd\n.\nFinally, enable and start the\nsaslauthd\nservice:\nsudo systemctl enable saslauthd\nsudo systemctl start saslauthd\nExim4 is now configured with SMTP-AUTH using TLS authenticating local Linux users via PAM.\nAuthenticating arbitrary users\n¶\nExim4 can also be configured to authenticate arbitrary users, that is, users that do note exist on the local system. These mechanisms are called\nplain_server\nand\nlogin_server\n. Edit\n/etc/exim4/conf.d/auth/30_exim4-config_examples\nand uncomment these sections:\nplain_server:\n  driver = plaintext\n  public_name = PLAIN\n  server_condition = \"${if crypteq{$auth3}{${extract{1}{:}{${lookup{$auth2}lsearch{CONFDIR/passwd}{$value}{*:*}}}}}{1}{0}}\"\n  server_set_id = $auth2\n  server_prompts = :\n  .ifndef AUTH_SERVER_ALLOW_NOTLS_PASSWORDS\n  server_advertise_condition = ${if eq{$tls_in_cipher}{}{}{*}}\n  .endif\n\nlogin_server:\n  driver = plaintext\n  public_name = LOGIN\n  server_prompts = \"Username:: : Password::\"\n  server_condition = \"${if crypteq{$auth2}{${extract{1}{:}{${lookup{$auth1}lsearch{CONFDIR/passwd}{$value}{*:*}}}}}{1}{0}}\"\n  server_set_id = $auth1\n  .ifndef AUTH_SERVER_ALLOW_NOTLS_PASSWORDS\n  server_advertise_condition = ${if eq{$tls_in_cipher}{}{}{*}}\n  .endif\nWarning\nDO NOT enable both these and the\n_saslauthd_server\nvariants (from “Authenticating existing Linux users” above) at the same time!\nThese mechanisms will lookup usernames and passwords in the\n/etc/exim4/passwd\nfile, which has to be created and populated. The format of this file is:\nusername:crypted-password:cleartext-password\nThe Exim4 installation ships a helper script that can populate this file. It is a simple interactive script that can be run like this:\nsudo /usr/share/doc/exim4-base/examples/exim-adduser\nIt will prompt for a username and password. In this example we are creating an\nubuntu\nentry with the password\nubuntusecret\n:\nUser: ubuntu\nPassword: ubuntusecret\nAfter that, we will have a\n/etc/exim4/passwd\nfile, owned by\nroot:root\nand mode\n0644\n, with contents similar to this:\nubuntu:$1$ZvPA$HTddFobmJD1vURtJHBmbw/:ubuntusecret\nSince this file contains secrets, it should be protected, and Exim4 has to be allowed to read it:\nsudo chown root:Debian-exim /etc/exim4/passwd\nsudo chmod 0640 /etc/exim4/passwd\nThe same script can also be used to manage users in this\npasswd\nfile:\nTo change the password of an existing user, edit the\npasswd\nfile, delete the line corresponding to the user, save the file, and run the script again to provide the new password.\nTo add another user, run the script and provide the new user name, and their password.\nTo remove a user, edit the file with a text editor and delete the line corresponding to the user that should be removed.\nWarning\nThe\n/usr/share/doc/exim4-base/examples/exim-adduser\nserves mostly as an example and is not able to handle many scenarios. For example, it won’t check if the username you are providing already exists in the\npasswd\nfile, which can lead to multiple entries for the same user, with unpredictable results.\nFinally, update the Exim4 configuration and restart the service:\nsudo\nupdate-exim4.conf\nsudo\nsystemctl\nrestart\nexim4\nNote\nThere is no need to restart Exim4 after making changes to the\n/etc/exim4/passwd\nfile.\nTroubleshooting\n¶\nExim4 has logs in its own directory in\n/var/log/exim4/mainlog\n. Whenever troubleshooting the service, always look at that log file.\nA quick test to verify if\nsaslauthd\nis working can be performed with the\ntestsaslauthd\ncommand. Assuming you have a local user called\nubuntu\nwith a password of\nubuntusecret\n, this command can be used to test the authentication on the Exim4 server:\ntestsaslauthd -u ubuntu -p ubuntusecret\nThe result should be OK:\n0: OK \"Success.\"\nNote that this tests only the\nsaslauthd\nservice, not the Exim4 integration with it. For that we need to actually connect to the SMTP service and try out the authentication. A good helper tool for this is shipped in the\ncyrus-clients\npackage. Since this is part of another email system, it’s best to install it on another machine, and not on the same machine as Exim4.\nsudo apt install cyrus-clients --no-install-recommends\nHere we are using the extra\n--no-install-recommends\noption because we don’t need all the other components of the Cyrus email system.\nThe tool we are interested in is called\nsmtptest\n, and its documentation can be inspected in its manual page at\ncyrus-smtptest(1)\n.\nFor our purposes, we will run it like this, assuming an\nubuntu\nuser with the\nubuntusecret\npassword, and that the Exim4 server is running on the\nn-exim.lxd\nsystem:\n/usr/lib/cyrus/bin/smtptest -t \"\" -a ubuntu -w ubuntusecret n-exim.lxd\nThe command-line parameters are:\n-t\n\"\"\n: Enable TLS.\n-a\nubuntu\n: Use\nubuntu\nas the authenticating user.\n-w\nubuntusecret\n: Authenticate using the\nubuntusecret\npassword.\nn-exim.lxd\n: The hostname of the Exim4 server to connect to.\nIf all works well, the output will be similar to this, showing that the connection was switched to TLS, and the authentication worked:\nS: 220 n-exim ESMTP Exim 4.97 Ubuntu Mon, 23 Jun 2025 21:11:59 +0000\nC: EHLO smtptest\nS: 250-n-exim Hello n-exim.lxd [10.10.17.9]\nS: 250-SIZE 52428800\nS: 250-8BITMIME\nS: 250-PIPELINING\nS: 250-PIPECONNECT\nS: 250-CHUNKING\nS: 250-STARTTLS\nS: 250-PRDR\nS: 250 HELP\nC: STARTTLS\nS: 220 TLS go ahead\nverify error:num=18:self-signed certificate\nTLS connection established: TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)\nC: EHLO smtptest\nS: 250-n-exim Hello n-exim.lxd [10.10.17.9]\nS: 250-SIZE 52428800\nS: 250-8BITMIME\nS: 250-PIPELINING\nS: 250-PIPECONNECT\nS: 250-AUTH PLAIN LOGIN\nS: 250-CHUNKING\nS: 250-PRDR\nS: 250 HELP\nC: AUTH LOGIN\nS: 334 VXNlcm5hbWU6\nC: dWJ1bnR1\nS: 334 UGFzc3dvcmQ6\nC: dWJ1bnR1c2VjcmV0\nS: 235 Authentication succeeded\nAuthenticated.\nSecurity strength factor: 256\nIt will appear to hang at this point, but it’s just waiting for the SMTP commands, i.e., receive an email. You can exit by typing\nQUIT\nfollowed by pressing enter.\nInteresting points to note in the output above:\nNo authentication was offered before the connection was switched to TLS. That’s because the only mechanisms which are configured are plain-text ones. Without TLS, the password would be exposed on the network.\nSince this documentation used a self-signed certificate, that was highlighted right before the TLS session was established. A real email client would probably abort the connnection at this point.\nAfter TLS was established, the\nLOGIN\nmechanism was chosen.\nThe username and password are sent base64 encoded. Do not mistake that for encryption: this is just an encoding mechanism!\nTip\nWant to obtain the original username and password back from the base64 encoded values? Feed those values to the\nbase64\n-d\ntool. Example, using the value from the session above:\n$ echo -n dWJ1bnR1c2VjcmV0 | base64 -d; echo\nubuntusecret\nTo test the\nPLAIN\nmechanism, add the\n-m\nplain\ncommand-line option:\n/usr/lib/cyrus/bin/smtptest -t \"\" -a ubuntu -w ubuntusecret -m plain n-exim.lxd\nIn the new output,\nPLAIN\nwas selected:\nS: 220 n-exim ESMTP Exim 4.97 Ubuntu Mon, 23 Jun 2025 21:15:39 +0000\nC: EHLO smtptest\nS: 250-n-exim Hello n-exim.lxd [10.10.17.9]\nS: 250-SIZE 52428800\nS: 250-8BITMIME\nS: 250-PIPELINING\nS: 250-PIPECONNECT\nS: 250-CHUNKING\nS: 250-STARTTLS\nS: 250-PRDR\nS: 250 HELP\nC: STARTTLS\nS: 220 TLS go ahead\nverify error:num=18:self-signed certificate\nTLS connection established: TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)\nC: EHLO smtptest\nS: 250-n-exim Hello n-exim.lxd [10.10.17.9]\nS: 250-SIZE 52428800\nS: 250-8BITMIME\nS: 250-PIPELINING\nS: 250-PIPECONNECT\nS: 250-AUTH PLAIN LOGIN\nS: 250-CHUNKING\nS: 250-PRDR\nS: 250 HELP\nC: AUTH PLAIN AHVidW50dQB1YnVudHVzZWNyZXQ=\nS: 235 Authentication succeeded\nAuthenticated.\nSecurity strength factor: 256\nTroubleshooting tips\n¶\nHere are some troubleshooting tips.\nPermissions\n¶\nIf using\nsaslauthd\n: Can the\nDebian-exim\nuser read and write to the\nsaslauthd\nsocket in\n/run/saslauthd/mux\nsocket?\nIf using\n/etc/exim4/passwd\n: Can the\nDebian-exim\nuser read this file?\nConfig\n¶\nIf changing a configuration file under\n/etc/exim4/conf.d/\n, make sure to be using the split-config mode! Check the\n/etc/exim4/update-exim4.conf.conf\nfile to see which mode is in use.\nSimilarly, if changing the configuration file\n/etc/exim4/exim4.conf.template\n, make sure to be using the non-split mode.\nAfter any configuration file change, be it split mode or not, be sure to run\nsudo\nupdate-exim4.conf\nand restart the\nexim4\nservice.\nFurther reading\n¶\nSee\nexim.org\nfor more information.\nAnother resource is the\nExim4 Ubuntu Wiki\npage.\nFurther resources to\nset up mailman3 with Exim4\n.", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:18Z", "original_len_words": 2093}}
{"id": "b4b5dfb147", "source_url": "https://documentation.ubuntu.com/server/how-to/mail-services/install-postfix/", "title": "Install and configure Postfix - Ubuntu Server documentation", "text": "Install and configure Postfix - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nInstall and configure Postfix\n¶\nNote\nThis guide does not cover setting up Postfix\nVirtual Domains\n. For information on Virtual Domains and other advanced configurations see the references list at the end of this page.\nInstall Postfix\n¶\nTo install\nPostfix\nrun the following command:\nsudo\napt\ninstall\npostfix\nIt is OK to accept defaults initially by pressing return for each question. Some of the configuration options will be investigated in greater detail in the configuration stage.\nWarning\nThe\nmail-stack-delivery\nmetapackage has been deprecated in Focal. The package still exists for compatibility reasons, but won’t setup a working email system.\nConfigure Postfix\n¶\nThere are four things you should decide before configuring:\nThe <Domain> for which you’ll accept email (we’ll use\nmail.example.com\nin our example)\nThe network and class range of your mail server (we’ll use\n192.168.0.0/24\n)\nThe username (we’re using\nsteve\n)\nType of mailbox format (\nmbox\nis the default, but we’ll use the alternative,\nMaildir\n)\nTo configure postfix, run the following command:\nsudo\ndpkg-reconfigure\npostfix\nThe user interface will be displayed. On each screen, select the following values:\nInternet Site\nmail.example.com\nsteve\nmail.example.com\n,\nlocalhost.localdomain\n,\nlocalhost\nNo\n127.0.0.0/8\n\\[::ffff:127.0.0.0\\]/104\n\\[::1\\]/128\n192.168.0.0/24\n0\n+\nall\nTo set the mailbox format, you can either edit the configuration file directly, or use the\npostconf\ncommand.  In either case, the configuration parameters will be stored in\n/etc/postfix/main.cf\nfile. Later if you wish to re-configure a particular parameter, you can either run the command or change it manually in the file.\nConfigure mailbox format\n¶\nTo configure the mailbox format for\nMaildir\n:\nsudo\npostconf\n-e\n'home_mailbox = Maildir/'\nThis will place new mail in\n/home/<username>/Maildir\nso you will need to configure your Mail Delivery Agent (MDA) to use the same path.\nSMTP authentication\n¶\nSMTP-AUTH allows a client to identify itself through the Simple Authentication and Security Layer (SASL) authentication mechanism, using Transport Layer Security (TLS) to encrypt the authentication process. Once it has been authenticated, the SMTP server will allow the client to relay mail.\nConfigure SMTP authentication\n¶\nTo configure Postfix for SMTP-AUTH using SASL (Dovecot SASL), run these commands at a terminal prompt:\nsudo\npostconf\n-e\n'smtpd_sasl_type = dovecot'\nsudo\npostconf\n-e\n'smtpd_sasl_path = private/auth'\nsudo\npostconf\n-e\n'smtpd_sasl_local_domain ='\nsudo\npostconf\n-e\n'smtpd_sasl_security_options = noanonymous'\nsudo\npostconf\n-e\n'broken_sasl_auth_clients = yes'\nsudo\npostconf\n-e\n'smtpd_sasl_auth_enable = yes'\nsudo\npostconf\n-e\n'smtpd_recipient_restrictions = \\\npermit_sasl_authenticated,permit_mynetworks,reject_unauth_destination'\nNote\nThe\nsmtpd_sasl_path\nconfig parameter is a path relative to the Postfix queue directory.\nThere are several SASL mechanism properties worth evaluating to improve the security of your deployment. The option “noanonymous” prevents the use of mechanisms that permit anonymous authentication.\nConfigure TLS\n¶\nNext, generate or obtain a digital certificate for TLS. MUAs connecting to your mail server via TLS will need to recognize the certificate used for TLS. This can either be done using a certificate from Let’s Encrypt, from a commercial CA or with a self-signed certificate that users manually install/accept.\nFor MTA-to-MTA, TLS certificates are never validated without prior agreement from the affected organizations. For MTA-to-MTA TLS, there is no reason not to use a self-signed certificate unless local policy requires it. See our\nguide on security certificates\nfor details about generating digital certificates and setting up your own Certificate Authority (CA).\nOnce you have a certificate, configure Postfix to provide TLS encryption for both incoming and outgoing mail:\nsudo\npostconf\n-e\n'smtp_tls_security_level = may'\nsudo\npostconf\n-e\n'smtpd_tls_security_level = may'\nsudo\npostconf\n-e\n'smtp_tls_note_starttls_offer = yes'\nsudo\npostconf\n-e\n'smtpd_tls_chain_files = /etc/ssl/private/server.key,/etc/ssl/certs/server.crt'\nsudo\npostconf\n-e\n'smtpd_tls_loglevel = 1'\nsudo\npostconf\n-e\n'smtpd_tls_received_header = yes'\nsudo\npostconf\n-e\n'myhostname = mail.example.com'\nIf you are using your own Certificate Authority to sign the certificate, enter:\nsudo\npostconf\n-e\n'smtpd_tls_CAfile = /etc/ssl/certs/cacert.pem'\nAgain, for more details about certificates see our\nsecurity certificates guide\n.\nOutcome of initial configuration\n¶\nAfter running all the above commands, Postfix will be configured for SMTP-AUTH with a self-signed certificate for TLS encryption.\nNow, the file\n/etc/postfix/main.cf\nshould look like this:\n# See /usr/share/postfix/main.cf.dist for a commented, more complete\n# version\n    \nsmtpd_banner = $myhostname ESMTP $mail_name (Ubuntu)\nbiff = no\n    \n# appending .domain is the MUA's job.\nappend_dot_mydomain = no\n    \n# Uncomment the next line to generate \"delayed mail\" warnings\n#delay_warning_time = 4h\n    \nmyhostname = server1.example.com\nalias_maps = hash:/etc/aliases\nalias_database = hash:/etc/aliases\nmyorigin = /etc/mailname\nmydestination = server1.example.com, localhost.example.com, localhost\nrelayhost =\nmynetworks = 127.0.0.0/8\nmailbox_command = procmail -a \"$EXTENSION\"\nmailbox_size_limit = 0\nrecipient_delimiter = +\ninet_interfaces = all\nsmtpd_sasl_local_domain =\nsmtpd_sasl_auth_enable = yes\nsmtpd_sasl_security_options = noanonymous\nbroken_sasl_auth_clients = yes\nsmtpd_recipient_restrictions =\npermit_sasl_authenticated,permit_mynetworks,reject _unauth_destination\nsmtpd_tls_auth_only = no\nsmtp_tls_security_level = may\nsmtpd_tls_security_level = may\nsmtp_tls_note_starttls_offer = yes\nsmtpd_tls_key_file = /etc/ssl/private/smtpd.key\nsmtpd_tls_cert_file = /etc/ssl/certs/smtpd.crt\nsmtpd_tls_CAfile = /etc/ssl/certs/cacert.pem\nsmtpd_tls_loglevel = 1\nsmtpd_tls_received_header = yes\nsmtpd_tls_session_cache_timeout = 3600s\ntls_random_source = dev:/dev/urandom\nThe Postfix initial configuration is now complete. Run the following command to restart the Postfix daemon:\nsudo\nsystemctl\nrestart\npostfix.service\nSASL\n¶\nPostfix supports SMTP-AUTH as defined in\nRFC2554\n. It is based on\nSASL\n. However it is still necessary to set up SASL authentication before you can use SMTP-AUTH.\nWhen using IPv6, the\nmynetworks\nparameter may need to be modified to allow IPv6 addresses, for example:\nmynetworks = 127.0.0.0/8, [::1]/128\nConfigure SASL\n¶\nPostfix supports two SASL implementations:\nCyrus SASL\nand\nDovecot SASL\n.\nTo enable Dovecot SASL the\ndovecot-core\npackage will need to be installed:\nsudo\napt\ninstall\ndovecot-core\nNext, edit\n/etc/dovecot/conf.d/10-master.conf\nand change the following:\nservice auth {\n  # auth_socket_path points to this userdb socket by default. It's typically\n  # used by dovecot-lda, doveadm, possibly imap process, etc. Its default\n  # permissions make it readable only by root, but you may need to relax these\n  # permissions. Users that have access to this socket are able to get a list\n  # of all usernames and get results of everyone's userdb lookups.\n  unix_listener auth-userdb {\n    #mode = 0600\n    #user = \n    #group = \n  }\n    \n  # Postfix smtp-auth\n  unix_listener /var/spool/postfix/private/auth {\n    mode = 0660\n    user = postfix\n    group = postfix\n  }\n }\nTo permit use of SMTP-AUTH by Outlook clients, change the following line in the\nauthentication mechanisms\nsection of\n/etc/dovecot/conf.d/10-auth.conf\nfrom:\nauth_mechanisms = plain\nto this:\nauth_mechanisms = plain login\nOnce you have configured Dovecot, restart it with:\nsudo\nsystemctl\nrestart\ndovecot.service\nTest your setup\n¶\nSMTP-AUTH configuration is complete – now it is time to test the setup. To see if SMTP-AUTH and TLS work properly, run the following command:\ntelnet\nmail.example.com\n25\nAfter you have established the connection to the Postfix mail server, type:\nehlo\nmail.example.com\nIf you see the following in the output, then everything is working perfectly. Type\nquit\nto exit.\n250-STARTTLS\n250-AUTH LOGIN PLAIN\n250-AUTH=LOGIN PLAIN\n250 8BITMIME\nTroubleshooting\n¶\nWhen problems arise, there are a few common ways to diagnose the cause.\nEscaping\nchroot\n¶\nThe Ubuntu Postfix package will, by default, install into a\nchroot\nenvironment for security reasons. This can add greater complexity when troubleshooting problems.\nTo turn off the\nchroot\nusage, locate the following line in the\n/etc/postfix/master.cf\nconfiguration file:\nsmtp      inet  n       -       -       -       -       smtpd\nModify it as follows:\nsmtp      inet  n       -       n       -       -       smtpd\nYou will then need to restart Postfix to use the new configuration. From a terminal prompt enter:\nsudo\nservice\npostfix\nrestart\nSMTPS\n¶\nIf you need secure SMTP, edit\n/etc/postfix/master.cf\nand uncomment the following line:\nsmtps     inet  n       -       -       -       -       smtpd\n  -o smtpd_tls_wrappermode=yes\n  -o smtpd_sasl_auth_enable=yes\n  -o smtpd_client_restrictions=permit_sasl_authenticated,reject\n  -o milter_macro_daemon_name=ORIGINATING\nLog viewing\n¶\nPostfix sends all log messages to\n/var/log/mail.log\n. However, error and warning messages can sometimes get lost in the normal log output so they are also logged to\n/var/log/mail.err\nand\n/var/log/mail.warn\nrespectively.\nTo see messages entered into the logs in real time you can use the\ntail\n-f\ncommand:\ntail\n-f\n/var/log/mail.err\nIncrease logging detail\n¶\nThe amount of detail recorded in the logs can be increased via the configuration options. For example, to increase TLS activity logging set the\nsmtpd_tls_loglevel\noption to a value from 1 to 4.\nsudo\npostconf\n-e\n'smtpd_tls_loglevel = 4'\nReload the service after any configuration change, to activate the new config:\nsudo\nsystemctl\nreload\npostfix.service\nLogging mail delivery\n¶\nIf you are having trouble sending or receiving mail from a specific domain you can add the domain to the\ndebug_peer_list\nparameter.\nsudo\npostconf\n-e\n'debug_peer_list = problem.domain'\nsudo\nsystemctl\nreload\npostfix.service\nIncrease daemon verbosity\n¶\nYou can increase the verbosity of any Postfix daemon process by editing the\n/etc/postfix/master.cf\nand adding a\n-v\nafter the entry. For example, edit the\nsmtp\nentry:\nsmtp\nunix\n-\n-\n-\n-\n-\nsmtp\n-v\nThen, reload the service as usual:\nsudo\nsystemctl\nreload\npostfix.service\nLog SASL debug info\n¶\nTo increase the amount of information logged when troubleshooting SASL issues you can set the following options in\n/etc/dovecot/conf.d/10-logging.conf\nauth_debug\n=\nyes\nauth_debug_passwords\n=\nyes\nAs with Postfix, if you change a Dovecot configuration the process will need to be reloaded:\nsudo\nsystemctl\nreload\ndovecot.service\nNote\nSome of the options above can drastically increase the amount of information sent to the log files. Remember to return the log level back to normal after you have corrected the problem – then reload the appropriate daemon for the new configuration to take effect.\nFurther reading\n¶\nAdministering a Postfix server can be a very complicated task. At some point you may need to turn to the Ubuntu community for more experienced help.\nThe\nPostfix website\ndocuments all available configuration options.\nO’Reilly’s\nPostfix: The Definitive Guide\nis rather dated but provides deep background information about configuration options.\nThe\nUbuntu Wiki Postfix\npage has more information from an Ubuntu context.\nThere is also a\nDebian Wiki Postfix\npage that’s a bit more up to date; they also have a set of\nPostfix Tutorials\nfor different Debian versions.\nInfo on how to\nset up mailman3 with postfix\n.", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:19Z", "original_len_words": 1669}}
{"id": "1b283722cf", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/", "title": "Networking - Ubuntu Server documentation", "text": "Networking - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nNetworking\n¶\nThis section contains how-to guides on most aspects of networking in Ubuntu. If you would like a broader overview of these topics before getting started, refer to our\nintroduction to networking\n.\nConfiguration\n¶\nNetwork configuration in Ubuntu is handled through Netplan. See our general walkthrough on\nConfiguring networks\n, or refer to\nthe Netplan documentation\nfor more specific instructions.\nNetwork tools\n¶\nThe File Transfer Protocol (FTP) can be set up to provide files for download.\nFile transfers with FTP\nThe Domain Name Service (DNS) maps IP addresses to fully qualified domain names (FQDN). The DNS Security Extensions (DNSSEC) allow DNS data to be verified.\nSet up a name server (DNS)\nSet up DNS Security Extensions (DNSSEC)\nDNSSEC Troubleshooting\nOpen vSwitch (OVS) with the Data Plane Development Kit (DPDK) provides virtual switching for network automation in virtualized environments.\nUse Open vSwitch with DPDK\nDHCP\n¶\nSet up Dynamic Host Configuration Protocol (DHCP) for automatic IP address assignment for devices on your network. There are two DHCP servers available in Ubuntu:\nisc-kea\nis the most modern, and is available from 23.04 onwards.\nInstall DHCP isc-kea\nInstall DHCP isc-dhcp-server\nTime synchronization\n¶\nThe Network Time Protocol (NTP) synchronizes time over a network. Ubuntu uses\nchrony\nby default to handle this. However, users can install and use\ntimedatectl\n/\ntimesyncd\ninstead if preferred.\nTime sync with chrony\nTime sync with timedatectl and timesyncd\nServing time with chrony\nNetwork shares\n¶\nSharing files and resources across a network is a common requirement - this is where the Network File System (NFS) comes in.\nNetwork File System (NFS) sharing\nIf you need to share network resources between Linux and Windows systems, see our sections on Samba and Active Directory.\nSamba\nActive Directory integration\nPrinting\n¶\nThe Common UNIX Printing System (CUPS) is the most common way to manage print services in Ubuntu.\nSet up a CUPS print server\nSee also\n¶\nExplanation:\nNetworking section", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:19Z", "original_len_words": 353}}
{"id": "569adb6a90", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/chrony-client/", "title": "Synchronize time using Chrony - Ubuntu Server documentation", "text": "Synchronize time using Chrony - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nSynchronize time using Chrony\n¶\nUbuntu uses\nchrony\nfor synchronizing time, which is installed by default as of Ubuntu 25.10. You can optionally use\ntimedatectl\n/\ntimesyncd\nto\nsynchronize time using systemd\n.\nCheck status of\nchrony\nclient\n¶\nThe current status of time synchronization can be checked with the\ntimedatectl\nstatus\ncommand, which is available via\nsystemd\nand will produce output like this:\nLocal time: Mo 2025-06-16 15:21:46 CEST\n           Universal time: Mo 2025-06-16 13:21:46 UTC\n                 RTC time: Mo 2025-06-16 13:21:46\n                Time zone: Europe/Berlin (CEST, +0200)\nSystem clock synchronized: yes\n              NTP service: active\n          RTC in local TZ: no\nFor more details on time accuracy, Chrony can be queried directly, using the\nchronyc\n-N\ntracking\ncommand, producing output like this:\nReference ID    : B97DBE7B (2.ntp.ubuntu.com)\nStratum         : 3\nRef time (UTC)  : Mon Jun 16 13:06:04 2025\nSystem time     : 0.000000004 seconds slow of NTP time\nLast offset     : +0.001758954 seconds\nRMS offset      : 0.017604901 seconds\nFrequency       : 3.889 ppm slow\nResidual freq   : +0.202 ppm\nSkew            : 1.458 ppm\nRoot delay      : 0.022837413 seconds\nRoot dispersion : 0.003050051 seconds\nUpdate interval : 1032.5 seconds\nLeap status     : Normal\nNetwork Time Security (NTS)\n¶\nChrony supports “Network Time Security” (NTS) and enables it by default, using the Ubuntu NTS pools. This is done by specifying a\nserver\nor\npool\nas usual. Afterwards, options can be listed and it is there that\nnts\ncan be added. For example:\nserver <server-fqdn-or-IP> iburst nts\n# or as concrete example\npool 1.ntp.ubuntu.com iburst maxsources 1 nts prefer\nFor\nvalidation of NTS enablement\n, one can list the time sources in use by executing the\nchronyc\n-N\nsources\ncommand, to find the timeserver in use, as indicated by the\n^*\nsymbol in the first column. Then check the\nauthdata\nof that connection using\nsudo\nchronyc\n-N\nauthdata\n. If the client was able to successfully establish a NTS connection, it will show the\nMode:\nNTS\nfield and non-zero values for\nKeyID\n,\nType\nand\nKLen\n:\n$ sudo chronyc -N authdata\nName/IP address             Mode KeyID Type KLen Last Atmp  NAK Cook CLen\n=========================================================================\n1.ntp.ubuntu.com             NTS     6   30  128  14d    0    0    8   64\n2.ntp.ubuntu.com             NTS     6   30  128  14d    0    0    8   64\n3.ntp.ubuntu.com             NTS     1   30  128  27d    0    0    8   64\n4.ntp.ubuntu.com             NTS     2   30  128  20d    0    0    5   64\nntp-bootstrap.ubuntu.com     NTS     3   30  128   7d    0    0    8   64\nNTS related constraints\n¶\nKey Exchange port:\nNTS/KE uses a separate port (4460/tcp)** to negotiate\nsecurity parameters, which are then used via the normal NTP port (123/udp).\nThis is a new deployment, running on different IP addresses than the\ntraditional Ubuntu NTP pool.\nWarning\nIf the network does not allow access to the Ubuntu NTS servers and required\nports, with the default configuration is in place,\nchrony\nwill not be able\nto adjust the system’s clock. To revert to NTP, edit the configuration file\nin\n/etc/chrony/sources.d/ubuntu-ntp-pools.sources\nand revert to using\nthe listed NTP servers in favor of the NTS ones.\nBad Clocks and secure time syncing:\nNTS is based on TLS, and TLS needs a\nreasonably correct clock. Due to that, an NTS-based sync might fail if the\nclock is too far off. On hardware affected by this problem, one can consider\nusing the\nnocerttimecheck\noption, which allows to set the number of times\nthat the time can be synced without checking validation and expiration.\nNote\nA new CA is installed in\n/etc/chrony/nts-bootstrap-ubuntu.crt\nthat is\nused specifically for the Ubuntu NTS bootstrap server, needed for when the\nclock is too far off. This is added to certificate set ID “1”, and defined\nvia\n/etc/chrony/conf.d/ubuntu-nts.conf\n.\nConfigure Chrony\n¶\nAn admin can control the timezone and how the system clock should relate to the\nhwclock\nusing the common\ntimedatectl\n[set-timezone/set-local-rtc]\ncommands, provided by\nsystemd\n. For more specific actions, like adding of time-sources, the\nchronyc\ncommand can be used. See\nman\nchronyc\nfor more details.\nOne can edit configuration in\n/etc/chrony/sources.d/\nto add/remove server lines. By default these servers are configured:\n# Use NTS by default\n# NTS uses an additional port to negotiate security: 4460/tcp\n# The normal NTP port remains in use: 123/udp\npool 1.ntp.ubuntu.com iburst maxsources 1 nts prefer\npool 2.ntp.ubuntu.com iburst maxsources 1 nts prefer\npool 3.ntp.ubuntu.com iburst maxsources 1 nts prefer\npool 4.ntp.ubuntu.com iburst maxsources 1 nts prefer\n# The bootstrap server is needed by systems without a hardware clock, or a very\n# large initial clock offset. The specified certificate set is defined in\n# /etc/chrony/conf.d/ubuntu-nts.conf.\npool ntp-bootstrap.ubuntu.com iburst maxsources 1 nts certset 1\nAfter adding or removing sources, they can be reloaded using\nsudo\nchrony\nreload\nsources\n.\nOf the pool,\n2.ubuntu.pool.ntp.org\nand\nntp.ubuntu.com\nalso support IPv6, if needed. If you need to force IPv6, there is also\nipv6.ntp.ubuntu.com\nwhich is not configured by default.\nTime sources provided by DHCP (option 42)\n¶\nChrony consumes time sources provided by DHCP (option 42). Those could be traditional, non-authenticated NTP sources. Should one want to avoid this behavior, overruling the choices made by a local DHCP administrator, it can be disabled in\n/etc/chrony/chrony.conf\n. To do that one would comment out the corresponding setting:\n# Use time sources from DHCP.\n# sourcedir /run/chrony-dhcp\nChrony time-daemon\n¶\nchronyd\nitself is a normal service, so you can check its status in more detail using:\nsystemctl\nstatus\nchrony\n.\nservice\nThe output produced will look something like this:\n● chrony.service - chrony, an NTP client/server\n     Loaded: loaded (/usr/lib/systemd/system/chrony.service; enabled; preset: enabled)\n     Active: active (running) since Mon 2025-06-02 11:27:09 CEST; 2 weeks 0 days ago\n       Docs: man:chronyd(8)\n             man:chronyc(1)\n             man:chrony.conf(5)\n   Main PID: 36027 (chronyd)\n      Tasks: 2 (limit: 28388)\n     Memory: 5.8M (peak: 6.8M swap: 604.0K swap peak: 4.5M)\n        CPU: 5.038s\n     CGroup: /system.slice/chrony.service\n             ├─36027 /usr/sbin/chronyd -F 1\n             └─36028 /usr/sbin/chronyd -F 1\n\n    Jun 02 11:27:09 questing chronyd[36027]: Using right/UTC timezone to obtain leap second data\n    Jun 02 11:27:09 questing chronyd[36027]: Loaded seccomp filter (level 1)\n    Jun 02 11:27:09 questing chronyd[36027]: Added pool 1.ntp.ubuntu.com\n    Jun 02 11:27:09 questing chronyd[36027]: Added pool 2.ntp.ubuntu.com\n    Jun 02 11:27:09 questing chronyd[36027]: Added pool 3.ntp.ubuntu.com\n    Jun 02 11:27:09 questing chronyd[36027]: Added pool 4.ntp.ubuntu.com\n    Jun 02 11:27:09 questing chronyd[36027]: Added pool ntp-bootstrap.ubuntu.com\n    Jun 02 11:27:09 questing systemd[1]: Started chrony.service - chrony, an NTP client/server.\nDefault configuration such as\nsourcedir\n,\nntsdumpdir\nor\nrtcsync\nis provided in\n/etc/chrony/chrony.conf\nand additional config files can be stored in\n/etc/chrony/conf.d/\n. The NTS servers from which to fetch time for\nchrony\nare in defined in\n/etc/chrony/sources.d/ubuntu-ntp-pools.sources\n. There are more advanced options documented in the\nchrony.conf(5)\nmanpage. Common use cases are specifying an explicit trusted certificate. After changing any part of the config file you need to restart\nchrony\n, as follows:\nsudo\nsystemctl\nrestart\nchrony.service\nNext steps\n¶\nIf you would now like to also serve the Network Time Protocol via\nchrony\n, this guide will walk you through\nhow to configure your Chrony setup\n.\nReferences\n¶\nchronyc(1)\nmanual page\nchronyd(8)\nmanual page\nchrony.conf(5)\nmanual page", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:19Z", "original_len_words": 1184}}
{"id": "44ad815dac", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/cups-print-server/", "title": "Install and configure a CUPS print server - Ubuntu Server documentation", "text": "Install and configure a CUPS print server - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nInstall and configure a CUPS print server\n¶\nThe\nCommon UNIX Printing System, or CUPS\n, is the most widely-used way to manage printing and print services in Ubuntu. This freely-available printing system has become the standard for printing in most Linux distributions, and uses the standard Internet Printing Protocol (IPP) to handle network printing.\nCUPS manages print jobs and queues, and provides support for a wide range of printers, from dot-matrix to laser, and many in between. CUPS also supports PostScript Printer Description (PPD) and auto-detection of network printers, and features a simple web-based configuration and administration tool.\nInstall CUPS\n¶\nA complete CUPS install has many package dependencies, but they can all be specified on the same command line. To perform a basic installation of CUPS, enter the following command in your terminal:\nsudo\napt\ninstall\ncups\nOnce the download and installation have finished, the CUPS server will be started automatically.\nConfigure the CUPS server\n¶\nThe CUPS server’s behavior is configured through directives found in the\n/etc/cups/cupsd.conf\nconfiguration file. This CUPS configuration file follows the same syntax as the main configuration file for the Apache HTTP server. Some examples of commonly-configured settings will be presented here.\nMake a copy of the configuration file\n¶\nWe recommend that you make a copy of the original CUPS configuration file and protect it from writing, before you start configuring CUPS. You will then have the original settings as a reference, which you can reuse or restore as necessary.\nsudo\ncp\n/etc/cups/cupsd.conf\n/etc/cups/cupsd.conf.original\nsudo\nchmod\na-w\n/etc/cups/cupsd.conf.original\nConfigure Server administrator\n¶\nTo configure the email address of the designated CUPS server administrator, edit the\n/etc/cups/cupsd.conf\nconfiguration file with your preferred text editor, and add or modify the\nServerAdmin\nline accordingly. For example, if you are the administrator for the CUPS server, and your e-mail address is\nbjoy@somebigco.com\n, then you would modify the ServerAdmin line to appear as follows:\nServerAdmin bjoy@somebigco.com\nConfigure Listen\n¶\nBy default on Ubuntu, CUPS listens only on the loopback interface at IP address\n127.0.0.1\n.\nTo instruct CUPS to listen on an actual network adapter’s IP address, you must specify either a\nhostname\n, the IP address, or (optionally) an IP address/port pairing via the addition of a\nListen\ndirective.\nFor example, if your CUPS server resides on a local network at the IP address\n192.168.10.250\nand you’d like to make it accessible to the other systems on this subnetwork, you would edit the\n/etc/cups/cupsd.conf\nand add a Listen directive, as follows:\nListen 127.0.0.1:631           # existing loopback Listen\nListen /var/run/cups/cups.sock # existing socket Listen\nListen 192.168.10.250:631      # Listen on the LAN interface, Port 631 (IPP)\nIn the example above, you can comment out or remove the reference to the Loopback address (\n127.0.0.1\n) if you do not want the CUPS daemon (\ncupsd\n) to listen on that interface, but would rather have it only listen on the Ethernet interfaces of the Local Area Network (LAN). To enable listening for all network interfaces for which a certain hostname is bound, including the Loopback, you could create a Listen entry for the hostname\nsocrates\nlike this:\nListen socrates:631  # Listen on all interfaces for the hostname 'socrates'\nor by omitting the Listen directive and using\nPort\ninstead, as in:\nPort 631  # Listen on port 631 on all interfaces\nFor more examples of configuration directives in the CUPS server configuration file, view the associated system manual page by entering the following command:\nman\ncupsd.conf\nPost-configuration restart\n¶\nWhenever you make changes to the\n/etc/cups/cupsd.conf\nconfiguration file, you’ll need to restart the CUPS server by typing the following command at a terminal prompt:\nsudo\nsystemctl\nrestart\ncups.service\nWeb Interface\n¶\nCUPS can be configured and monitored using a web interface, which by default is available at\nhttp://localhost:631/admin\n. The web interface can be used to perform all printer management tasks.\nTo perform administrative tasks via the web interface, you must either have the root account enabled on your server, or authenticate as a user in the\nlpadmin\ngroup. For security reasons, CUPS won’t authenticate a user that doesn’t have a password.\nTo add a user to the\nlpadmin\ngroup, run at the terminal prompt:\nsudo\nusermod\n-aG\nlpadmin\nusername\nFurther documentation is available in the “Documentation/Help” tab of the web interface.\nError logs\n¶\nFor troubleshooting purposes, you can access CUPS server errors via the error log file at:\n/var/log/cups/error_log\n. If the error log does not show enough information to troubleshoot any problems you encounter, the verbosity of the CUPS log can be increased by changing the\nLogLevel\ndirective in the configuration file (discussed above) from the default of “info” to “debug” or even “debug2”, which logs everything.\nIf you make this change, remember to change it back once you’ve solved your problem, to prevent the log file from becoming overly large.\nReferences\n¶\nCUPS Website\nDebian Open-iSCSI page", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:19Z", "original_len_words": 850}}
{"id": "04fa6b6aba", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/dnssec-troubleshooting/", "title": "Basic DNSSEC troubleshooting - Ubuntu Server documentation", "text": "Basic DNSSEC troubleshooting - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nBasic DNSSEC troubleshooting\n¶\nSome of the troubleshooting tips that will be shown here are focused on the BIND9\nDNS\nserver and its tools, but the general principle applies to\nDNSSEC\nin all implementations.\nHandy “bad” and “good” DNSSEC domains\n¶\nIt helps to have some good known domains with broken and working DNSSEC available for testing, so we can be sure our tooling is catching those, and not just failing everywhere. There is no guarantee that these domains will be up forever, and certainly there are more out there, but this list is a good first choice:\nThese should fail DNSSEC validation:\ndnssec-failed.org\nsigfail.ippacket.stream\nThese should pass DNSSEC validation:\nisc.org\nsigok.ippacket.stream\nLogs\n¶\nBy default, the BIND9 server will log certain DNSSEC failures, and the journal log should be the first place to check.\nFor example, if we ask a BIND9 Validating Resolver for the IP address of the\nwww.dnssec-failed.org\nname, we get a failure:\n$ dig @127.0.0.1 -t A www.dnssec-failed.org\n; <<>> DiG 9.18.28-0ubuntu0.24.04.1-Ubuntu <<>> @127.0.0.1 -t A www.dnssec-failed.org\n; (1 server found)\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: SERVFAIL, id: 26260\n;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 1232\n; COOKIE: 6339d7228b8587f401000000671bc2eb2fe25bdf099ef1af (good)\n;; QUESTION SECTION:\n;www.dnssec-failed.org.         IN      A\n\n;; Query time: 460 msec\n;; SERVER: 127.0.0.1#53(127.0.0.1) (UDP)\n;; WHEN: Fri Oct 25 16:10:19 UTC 2024\n;; MSG SIZE  rcvd: 78\nThat’s a very generic failure: it just says\nSERVFAIL\n, and gives us no IP:\nIN\nA\nis empty. The BIND9 logs, however, tell a more detailed story:\n$ journalctl -u named.service -f\n(...)\nnamed[286]: validating dnssec-failed.org/DNSKEY: no valid signature found (DS)\nnamed[286]: no valid RRSIG resolving 'dnssec-failed.org/DNSKEY/IN': 68.87.85.132#53\nnamed[286]: validating dnssec-failed.org/DNSKEY: no valid signature found (DS)\nnamed[286]: no valid RRSIG resolving 'dnssec-failed.org/DNSKEY/IN': 68.87.68.244#53\nnamed[286]: validating dnssec-failed.org/DNSKEY: no valid signature found (DS)\nnamed[286]: no valid RRSIG resolving 'dnssec-failed.org/DNSKEY/IN': 68.87.76.228#53\nnamed[286]: validating dnssec-failed.org/DNSKEY: no valid signature found (DS)\nnamed[286]: no valid RRSIG resolving 'dnssec-failed.org/DNSKEY/IN': 68.87.72.244#53\nnamed[286]: validating dnssec-failed.org/DNSKEY: no valid signature found (DS)\nnamed[286]: no valid RRSIG resolving 'dnssec-failed.org/DNSKEY/IN': 69.252.250.103#53\nnamed[286]: broken trust chain resolving 'www.dnssec-failed.org/A/IN': 68.87.72.244#53\nClient-side tooling: dig\n¶\nOne of the more versatile DNS troubleshooting tools is\ndig\n, generally used for interrogating DNS name servers to lookup and display domain information, but its broad functionality makes it a flexible aid for DNS troubleshooting. It provides direct control over setting most of the DNS flags in queries, and displays detailed responses for inspection.\nFor DNSSEC troubleshooting purposes, we are interested in the following features:\n+dnssec\n: Set the “DNSSEC OK” bit in the queries, which tells the resolver to include in its responses the DNSSEC RRSIG records. This is also shown as a\ndo\nflag in queries.\n+cd\n: This means\ncheck disabled\nand tells the resolver we can accept unauthenticated data in the DNS responses.\nad\n: When included in a response, this flag means\nauthenticated data\n, and tells us that the resolver who provided this answer has performed DNSSEC validation.\n@<IP>\n: This parameter lets us direct the query to a specific DNS server running at the provided IP address.\nFor example, let’s query the local systemd-resolved DNS stub resolver (running at\n127.0.0.53\n) for the\nisc.org\ntype\nA\nrecord, and request DNSSEC data:\n$ dig @127.0.0.53 -t A +dnssec +multiline isc.org\n\n; <<>> DiG 9.18.30-0ubuntu0.24.04.2-Ubuntu <<>> @127.0.0.53 -t A +dnssec +multiline isc.org\n; (1 server found)\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 13164\n;; flags: qr rd ra ad; QUERY: 1, ANSWER: 5, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags: do; udp: 65494\n;; QUESTION SECTION:\n;isc.org.\t\tIN A\n\n;; ANSWER SECTION:\nisc.org.\t\t300 IN A 151.101.130.217\nisc.org.\t\t300 IN A 151.101.66.217\nisc.org.\t\t300 IN A 151.101.2.217\nisc.org.\t\t300 IN A 151.101.194.217\nisc.org.\t\t300 IN RRSIG A 13 2 300 (\n\t\t\t\t20250830114017 20250816111944 27566 isc.org.\n\t\t\t\tu6hKKZGX3DUD6JJAjHsGog+nfR9bz5qp2g1h3qibZI+A\n\t\t\t\tqWH05fWJJjoSMzcnOgzIO1299zPIZd0xdMAh1wbkjw== )\n\n;; Query time: 83 msec\n;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)\n;; WHEN: Mon Aug 25 13:28:33 CEST 2025\n;; MSG SIZE  rcvd: 203\nLet’s unpack this answer for the important troubleshooting parts:\nThe answer has the\nad\nflag set, meaning this data was authenticated. In other words, DNSSEC validation was successful.\nThe status of the query is\nNOERROR\n, and we have 5 records in the answer section.\nAn RRSIG record for the “A” Resource Record was returned as requested by the\n+dnssec\ncommand-line parameter. This is also confirmed by the presence of the “do” flag in the “OPT PSEUDOSECTION”.\nIf we repeat this query with a domain that we know fails DNSSEC validation, we get the following reply:\n$ dig @127.0.0.53 -t A +dnssec +multiline dnssec-failed.org\n\n; <<>> DiG 9.18.30-0ubuntu0.24.04.2-Ubuntu <<>> @127.0.0.53 -t A +dnssec +multiline dnssec-failed.org\n; (1 server found)\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: SERVFAIL, id: 8314\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 2\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags: do; udp: 65494\n;; QUESTION SECTION:\n;dnssec-failed.org.\tIN A\n\n;; ANSWER SECTION:\ndnssec-failed.org.\t300 IN A 96.99.227.255\n\n;; ADDITIONAL SECTION:\ndnssec-failed.org.\t300 IN RRSIG A 5 2 300 (\n\t\t\t\t20250904145125 20250818144625 44973 dnssec-failed.org.\n\t\t\t\tUF75l9JkH/AZ9ApNF86stA81B+L36j0F/L8ENvMknsfK\n\t\t\t\tFwll6cLEJWBalKeyhK7p3U/Lqet9L3Oti8H7RudmgZ4v\n\t\t\t\tkdYMDrb9mqnXscY1R/kmSrtu3gOO1ob+khKinyAVwKLb\n\t\t\t\tR0CVZnJLSb7c++BI9fRJjE2caZ+2RkHwkLATR28= )\n\n;; Query time: 138 msec\n;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)\n;; WHEN: Mon Aug 25 13:37:11 CEST 2025\n;; MSG SIZE  rcvd: 239\nThis time:\nThere is no\nad\nflag set in the answer.\nThe status of the query is a generic\nSERVFAIL\n, and zero answers were provided.\nWe can tell the local stub resolver (systemd-resolved running at\n@127.0.0.53\naddress) that we don’t want it to perform DNSSEC validation. We do that by setting the\n+cd\n(check disabled) flag. Then things change in our answer:\n$ dig @127.0.0.53 -t A +dnssec +cd +multiline dnssec-failed.org\n\n; <<>> DiG 9.18.30-0ubuntu0.24.04.2-Ubuntu <<>> @127.0.0.53 -t A +dnssec +cd +multiline dnssec-failed.org\n; (1 server found)\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 55352\n;; flags: qr rd ra cd; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags: do; udp: 65494\n; EDE: 9 (DNSKEY Missing)\n;; QUESTION SECTION:\n;dnssec-failed.org.\tIN A\n\n;; ANSWER SECTION:\ndnssec-failed.org.\t181 IN A 96.99.227.255\ndnssec-failed.org.\t181 IN RRSIG A 5 2 300 (\n\t\t\t\t20250904145125 20250818144625 44973 dnssec-failed.org.\n\t\t\t\tUF75l9JkH/AZ9ApNF86stA81B+L36j0F/L8ENvMknsfK\n\t\t\t\tFwll6cLEJWBalKeyhK7p3U/Lqet9L3Oti8H7RudmgZ4v\n\t\t\t\tkdYMDrb9mqnXscY1R/kmSrtu3gOO1ob+khKinyAVwKLb\n\t\t\t\tR0CVZnJLSb7c++BI9fRJjE2caZ+2RkHwkLATR28= )\n\n;; Query time: 3 msec\n;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)\n;; WHEN: Mon Aug 25 13:39:09 CEST 2025\n;; MSG SIZE  rcvd: 245\nLooks like we have some sort of answer, but:\nThere is no\nad\nflag in the answer, so this data was not authenticated.\nThe status is\nNOERROR\n, and we got two answers.\nNote there is a\ncd\nflag in the answer, meaning “check disabled”. No attempt at validating the answer was done by the resolver, as requested.\nIn none of these cases, though, did\ndig\nperform DNSSEC validation: it just presented the results provided by the resolver, which in some cases was no validation at all (via the\n+cd\nflag). To perform the validation ourselves, we have to use a different tool.\nDigging a bit deeper:\ndelv\n¶\nThe\ndelv\ntool is very similar to\ndig\n, and can perform the same DNS queries, but with a crucial difference: it can also validate DNSSEC. This is very useful in troubleshooting, because rather than returning a generic\nSERVFAIL\nerror when something goes wrong with DNSSEC validation, it can tell us what was wrong in more detail.\nBut to bring the responsibility of doing DNSSEC validation to the tool itself, we use the\n+cd\nflag in our queries, to tell the resolver to not attempt that validation. Otherwise we will just get back a generic\nSERVFAIL\nerror:\n$ delv @127.0.0.53 -t A +dnssec +multiline dnssec-failed.org\n;; resolution failed: SERVFAIL\nWith the\n+cd\nflag present, however,\ndelv\nitself will do the validation. It will fail again, but now with a DNSSEC-specific error:\n$ delv @127.0.0.53 -t A +dnssec +cd +multiline dnssec-failed.org\n;; validating dnssec-failed.org/DNSKEY: no valid signature found (DS)\n;; no valid RRSIG resolving 'dnssec-failed.org/DNSKEY/IN': 127.0.0.1#53\n;; broken trust chain resolving 'dnssec-failed.org/A/IN': 127.0.0.1#53\n;; resolution failed: broken trust chain\nIf needed,\ndelv\ncan be told to not perform DNSSEC validation at all, by passing the\n-i\nflag. Together with the\n+cd\nflag, which instructs the Validating Resolver to not perform validation either, we get this result:\n$ delv @127.0.0.53 -i -t A +dnssec +cd +multiline dnssec-failed.org\n; answer not validated\ndnssec-failed.org.      100 IN A 96.99.227.255\nFor a good DNSSEC domain,\ndelv\nwill return a validated answer:\n$ delv @127.0.0.53 -t A +multiline +cd isc.org\n; fully validated\nisc.org.\t\t299 IN A 151.101.2.217\nisc.org.\t\t299 IN A 151.101.66.217\nisc.org.\t\t299 IN A 151.101.130.217\nisc.org.\t\t299 IN A 151.101.194.217\nisc.org.\t\t299 IN RRSIG A 13 2 300 (\n\t\t\t\t20250908112301 20250825104017 27566 isc.org.\n\t\t\t\t9oclTno0Ub2NmUEXdyLv0zqwPBbbUVmT3RX4aP4BQQ+h\n\t\t\t\t4g839JXuCKHufXSPkWh/GJe/MveP83dDvJkrMmEIzg== )\nGiven that above we used the\n+cd\nflag, this means that the validation was done by\ndelv\nitself. We will get the same result without that flag if the resolver also succeeds in the DNSSEC validation, and provides an answer.\nClient-side tooling: resolvectl\n¶\nThe local stub resolver\nsystemd-resolved\ncan perform DNSSEC validation locally using its high-level\nresolvectl\ntool. The local cache and state about DNS servers should be reset in systemd-resolved, to get reliable results.\nFlush systemd-resolved caches & state and confirm DNSSEC is enabled:\n$ sudo resolvectl flush-caches\n$ sudo resolvectl reset-server-features\n$ sudo resolvectl dnssec eth0 yes\n$ resolvectl dnssec\nGlobal: no\nLink 44 (eth0): yes\nQuery a DNSSEC enabled domain and confirm the data was fetched from the network and authenticated, as displayed by the\nData\nis\nauthenticated\nand\nData\nfrom\nfields:\n$ resolvectl query --type=MX isc.org\nisc.org IN MX 5 mx.pao1.isc.org                             -- link: eth0\nisc.org IN MX 10 mx.ams1.isc.org                            -- link: eth0\n\n-- Information acquired via protocol DNS in 3.0ms.\n-- Data is authenticated: yes; Data was acquired via local or encrypted transport: no\n-- Data from: network\nIncorrect time\n¶\nAs with everything related to cryptography, having an accurate measurement of time is of crucial importance. In a nutshell, digital signatures and keys have expiration dates.\nAn RRSIG record (a digital signature of a Resource Record) has a validity. For example, this record:\nnoble.example.internal. 86400 IN RRSIG A 13 3 86400 (\n                                20241106131533 20241023195023 48112 example.internal.\n                                5fL4apIwCD9kt4XbzzlLxMXY3mj8Li1WZu3qzlcBpERp\n                                lXPgLODbRrWyp7L81xEFnfhecKtEYv+6Y0Xa5iVRug== )\nHas this validity range:\nvalid until: 20241106131533 (2024-11-06 13:15:33 UTC)\nvalid since: 20241023195023 (2024-10-23 19:50:23 UTC)\nIf the DNSSEC validator has an incorrect clock, outside of the validity range, the DNSSEC validation will fail. For example, with the clock incorrectly set to before the beginning of the validity period,\ndelv\nwill complain like this:\n$ date\nTue Oct 10 10:10:19 UTC 2000\n\n$ delv @10.10.17.229 -a example.internal.key +root=example.internal +multiline noble.example.internal\n;; validating example.internal/DNSKEY: verify failed due to bad signature (keyid=48112): RRSIG validity period has not begun\n;; validating example.internal/DNSKEY: no valid signature found (DS)\n;; no valid RRSIG resolving 'example.internal/DNSKEY/IN': 10.10.17.229#53\n;; broken trust chain resolving 'noble.example.internal/A/IN': 10.10.17.229#53\n;; resolution failed: broken trust chain\nAny other Validating Resolver will fail in a similar way, and should indicate this error in its logs.\nBIND9 will complain loudly if it’s running on a system with an incorrect clock, as the root zones will fail validation:\nnamed[3593]: managed-keys-zone: DNSKEY set for zone '.' could not be verified with current keys\nnamed[3593]:   validating ./DNSKEY: verify failed due to bad signature (keyid=20326): RRSIG validity period has not begun\nnamed[3593]:   validating ./DNSKEY: no valid signature found (DS)\nnamed[3593]: broken trust chain resolving './NS/IN': 199.7.83.42#53\nnamed[3593]: resolver priming query complete: broken trust chain\nThird-party Web-based diagnostics\n¶\nThere are some public third-party web-based tools that will check the status of DNSSEC of a public domain. Here are some:\nhttps://dnsviz.net\n: Returns a graphical diagram showing the chain of trust and where it breaks down, if that’s the case.\nhttps://dnssec-debugger.verisignlabs.com\n: A DNSSEC debugger which also shows the chain of trust and where it breaks down, in a table format.\nFurther reading\n¶\nbind9’s guide to DNSSEC troubleshooting\nHow to validate DNSSEC using the command line\ndelv(1)\nmanpage\ndig(1)\nmanpage", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:20Z", "original_len_words": 2047}}
{"id": "dabbea026e", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/dpdk-with-open-vswitch/", "title": "How to use Open vSwitch with DPDK - Ubuntu Server documentation", "text": "How to use Open vSwitch with DPDK - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nHow to use Open vSwitch with DPDK\n¶\nSince\nDPDK is\njust\na library\n, it doesn’t do a lot on its own so it depends on emerging projects making use of it. One consumer of the library that is already part of Ubuntu is Open vSwitch with DPDK (OvS-DPDK) support in the package\nopenvswitch-switch-dpdk\n.\nHere is a brief example of how to install and configure a basic Open vSwitch using DPDK for later use via\nlibvirt\n/\nqemu-kvm\n.\nsudo\napt\n-\nget\ninstall\nopenvswitch\n-\nswitch\n-\ndpdk\nsudo\nupdate\n-\nalternatives\n--\nset\novs\n-\nvswitchd\n/\nusr\n/\nlib\n/\nopenvswitch\n-\nswitch\n-\ndpdk\n/\novs\n-\nvswitchd\n-\ndpdk\novs\n-\nvsctl\nset\nOpen_vSwitch\n.\n\"other_config:dpdk-init=true\"\n# run on core 0 only\novs\n-\nvsctl\nset\nOpen_vSwitch\n.\n\"other_config:dpdk-lcore-mask=0x1\"\n# Allocate 2G huge pages (not Numa node aware)\novs\n-\nvsctl\nset\nOpen_vSwitch\n.\n\"other_config:dpdk-alloc-mem=2048\"\n# limit to one whitelisted device\novs\n-\nvsctl\nset\nOpen_vSwitch\n.\n\"other_config:dpdk-extra=--pci-whitelist=0000:04:00.0\"\nsudo\nservice\nopenvswitch\n-\nswitch\nrestart\nNote\nYou need to assign devices to DPDK-compatible drivers before restarting –  see the DPDK section on\nunassigning the default kernel drivers\n.\nPlease note that the section\n_dpdk-alloc-mem=2048_\nin the above example is the most basic non-uniform memory access (NUMA) setup for a single socket system. If you have multiple sockets you may want to define how the memory should be split among them. More details about these options are outlined in\nOpen vSwitch setup\n.\nAttach DPDK ports to Open vSwitch\n¶\nThe Open vSwitch you started above supports all the same port types as Open vSwitch usually does,\nplus\nDPDK port types. The following example shows how to create a bridge and – instead of a normal external port – add an external DPDK port to it. When doing so you can specify the associated device.\novs\n-\nvsctl\nadd\n-\nbr\novsdpdkbr0\n--\nset\nbridge\novsdpdkbr0\ndatapath_type\n=\nnetdev\novs\n-\nvsctl\nadd\n-\nport\novsdpdkbr0\ndpdk0\n--\nset\nInterface\ndpdk0\ntype\n=\ndpdk\n\"options:dpdk-devargs=$\n{OVSDEV_PCIID}\n\"\nYou can tune this further by setting options:\novs\n-\nvsctl\nset\nInterface\ndpdk0\n\"options:n_rxq=2\"\nOpen vSwitch DPDK to KVM guests\n¶\nIf you are not building some sort of software-defined networking (SDN) switch or NFV on top of DPDK, it is very likely that you want to forward traffic to KVM guests. The good news is; with the new\nqemu\n/\nlibvirt\n/\ndpdk\n/\nopenvswitch\nversions in Ubuntu this is no longer about manually appending a command line string. This section demonstrates a basic setup to connect a KVM guest to an Open vSwitch DPDK instance.\nThe recommended way to get to a KVM guest is using\nvhost_user_client\n. This will cause OvS-DPDK to connect to a socket created by QEMU. In this way, we can avoid old issues like “guest failures on OvS restart”. Here is an example of how to add such a port to the bridge you created above.\novs\n-\nvsctl\nadd\n-\nport\novsdpdkbr0\nvhost\n-\nuser\n-\n1\n--\nset\nInterface\nvhost\n-\nuser\n-\n1\ntype\n=\ndpdkvhostuserclient\n\"options:vhost-server-path=/var/run/vhostuserclient/vhost-user-client-1\"\nThis will connect to the specified path that has to be created by a guest listening for it.\nTo let\nlibvirt\n/\nkvm\nconsume this socket and create a guest VirtIO network device for it, add the following snippet to your guest definition as the network definition.\n<\ninterface\ntype\n=\n'vhostuser'\n>\n<\nsource\ntype\n=\n'unix'\npath\n=\n'/var/run/vhostuserclient/vhost-user-client-1'\nmode\n=\n'server'\n/>\n<\nmodel\ntype\n=\n'virtio'\n/>\n</\ninterface\n>\nTuning Open vSwitch-DPDK\n¶\nDPDK has plenty of options – in combination with Open vSwitch-DPDK the two most commonly used are:\novs\n-\nvsctl\nset\nOpen_vSwitch\n.\nother_config\n:\nn\n-\ndpdk\n-\nrxqs\n=\n2\novs\n-\nvsctl\nset\nOpen_vSwitch\n.\nother_config\n:\npmd\n-\ncpu\n-\nmask\n=\n0x6\nThe first line selects how many Rx Queues are to be used for each DPDK interface, while the second controls how many poll mode driver (PMD) threads to run (and where to run them). The example above will use two Rx Queues, and run PMD threads on CPU 1 and 2.\nSee also\nCheck the links to\nEAL\nCommand-line Options and “Open vSwitch DPDK installation” at the end of this document for more information.\nAs usual with tunings, you need to know your system and workload really well - so please verify any tunings with workloads matching your real use case.\nSupport and troubleshooting\n¶\nDPDK is a fast-evolving project. In any search for support and/or further guides, we highly recommended first checking to see if they apply to the current version.\nYou can check if your issues is known on:\nDPDK Mailing Lists\nFor OpenVswitch-DPDK\nOpenStack Mailing Lists\nKnown issues in\nDPDK Launchpad Area\nJoin the IRC channels #DPDK or #openvswitch on\nfreenode\n.\nIssues are often due to missing small details in the general setup. Later on, these missing details cause problems which can be hard to track down to their root cause.\nA common case seems to be the “could not open network device dpdk0 (No such device)” issue. This occurs rather late when setting up a port in Open vSwitch with DPDK, but the root cause (most of the time) is very early in the setup and initialization. Here is an example of how proper initialization of a device looks - this can be found in the\nsyslog/journal\nwhen starting Open vSwitch with DPDK enabled.\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nPCI\ndevice\n0000\n:\n04\n:\n00.1\non\nNUMA\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nprobe\ndriver\n:\n8086\n:\n1528\nrte_ixgbe_pmd\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nPCI\nmemory\nmapped\nat\n0x7f2140000000\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nPCI\nmemory\nmapped\nat\n0x7f2140200000\nIf this is missing, either by ignored cards, failed initialisation or other reasons, later on there will be no DPDK device to refer to. Unfortunately, the logging is spread across\nsyslog/journal\nand the\nopenvswitch\nlog. To enable some cross-checking, here is an example of what can be found in these logs, relative to the entered command.\n#Note: This log was taken with dpdk 2.2 and openvswitch 2.5 but still looks quite similar (a bit extended) these days\nCaptions\n:\nCMD\n:\nthat\nyou\nenter\nSYSLOG\n:\n(\nInlcuding\nEAL\nand\nOVS\nMessages\n)\nOVS\n-\nLOG\n:\n(\nOpenvswitch\nmessages\n)\n#PREPARATION\nBind\nan\ninterface\nto\nDPDK\nUIO\ndrivers\n,\nmake\nHugepages\navailable\n,\nenable\nDPDK\non\nOVS\nCMD\n:\nsudo\nservice\nopenvswitch\n-\nswitch\nrestart\nSYSLOG\n:\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n31.372\nZ\n|\n00003\n|\ndaemon_unix\n(\nmonitor\n)\n|\nINFO\n|\npid\n3329\ndied\n,\nkilled\n(\nTerminated\n),\nexiting\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n33.377\nZ\n|\n00002\n|\nvlog\n|\nINFO\n|\nopened\nlog\nfile\n/\nvar\n/\nlog\n/\nopenvswitch\n/\novs\n-\nvswitchd\n.\nlog\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n33.381\nZ\n|\n00003\n|\novs_numa\n|\nINFO\n|\nDiscovered\n12\nCPU\ncores\non\nNUMA\nnode\n0\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n33.381\nZ\n|\n00004\n|\novs_numa\n|\nINFO\n|\nDiscovered\n1\nNUMA\nnodes\nand\n12\nCPU\ncores\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n33.381\nZ\n|\n00005\n|\nreconnect\n|\nINFO\n|\nunix\n:\n/\nvar\n/\nrun\n/\nopenvswitch\n/\ndb\n.\nsock\n:\nconnecting\n...\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n33.383\nZ\n|\n00006\n|\nreconnect\n|\nINFO\n|\nunix\n:\n/\nvar\n/\nrun\n/\nopenvswitch\n/\ndb\n.\nsock\n:\nconnected\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n33.386\nZ\n|\n00007\n|\nbridge\n|\nINFO\n|\novs\n-\nvswitchd\n(\nOpen\nvSwitch\n)\n2.5.0\nOVS\n-\nLOG\n:\nsystemd\n[\n1\n]:\nStopping\nOpen\nvSwitch\n...\nsystemd\n[\n1\n]:\nStopped\nOpen\nvSwitch\n.\nsystemd\n[\n1\n]:\nStopping\nOpen\nvSwitch\nInternal\nUnit\n...\novs\n-\nctl\n[\n3541\n]:\n*\nKilling\novs\n-\nvswitchd\n(\n3329\n)\novs\n-\nctl\n[\n3541\n]:\n*\nKilling\novsdb\n-\nserver\n(\n3318\n)\nsystemd\n[\n1\n]:\nStopped\nOpen\nvSwitch\nInternal\nUnit\n.\nsystemd\n[\n1\n]:\nStarting\nOpen\nvSwitch\nInternal\nUnit\n...\novs\n-\nctl\n[\n3560\n]:\n*\nStarting\novsdb\n-\nserver\novs\n-\nvsctl\n:\novs\n|\n00001\n|\nvsctl\n|\nINFO\n|\nCalled\nas\novs\n-\nvsctl\n--\nno\n-\nwait\n--\ninit\n--\nset\nOpen_vSwitch\n.\ndb\n-\nversion\n=\n7.12.1\novs\n-\nvsctl\n:\novs\n|\n00001\n|\nvsctl\n|\nINFO\n|\nCalled\nas\novs\n-\nvsctl\n--\nno\n-\nwait\nset\nOpen_vSwitch\n.\novs\n-\nversion\n=\n2.5.0\n\"external-ids:system-id=\n\\\"\ne7c5ba80-bb14-45c1-b8eb-628f3ad03903\n\\\"\n\"\n\"system-type=\n\\\"\nUbuntu\n\\\"\n\"\n\"system-version=\n\\\"\n16.04-xenial\n\\\"\n\"\novs\n-\nctl\n[\n3560\n]:\n*\nConfiguring\nOpen\nvSwitch\nsystem\nIDs\novs\n-\nctl\n[\n3560\n]:\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n31\nZ\n|\n00001\n|\ndpdk\n|\nINFO\n|\nNo\n-\nvhost_sock_dir\nprovided\n-\ndefaulting\nto\n/\nvar\n/\nrun\n/\nopenvswitch\novs\n-\nvswitchd\n:\novs\n|\n00001\n|\ndpdk\n|\nINFO\n|\nNo\n-\nvhost_sock_dir\nprovided\n-\ndefaulting\nto\n/\nvar\n/\nrun\n/\nopenvswitch\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n0\nas\ncore\n0\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n1\nas\ncore\n1\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n2\nas\ncore\n2\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n3\nas\ncore\n3\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n4\nas\ncore\n4\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n5\nas\ncore\n5\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n6\nas\ncore\n0\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n7\nas\ncore\n1\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n8\nas\ncore\n2\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n9\nas\ncore\n3\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n10\nas\ncore\n4\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\nlcore\n11\nas\ncore\n5\non\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nSupport\nmaximum\n128\nlogical\ncore\n(\ns\n)\nby\nconfiguration\n.\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nDetected\n12\nlcore\n(\ns\n)\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nVFIO\nmodules\nnot\nall\nloaded\n,\nskip\nVFIO\nsupport\n...\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nSetting\nup\nphysically\ncontiguous\nmemory\n...\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nAsk\na\nvirtual\narea\nof\n0x100000000\nbytes\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nVirtual\narea\nfound\nat\n0x7f2040000000\n(\nsize\n=\n0x100000000\n)\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nRequesting\n4\npages\nof\nsize\n1024\nMB\nfrom\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nTSC\nfrequency\nis\n~\n2397202\nKHz\novs\n-\nvswitchd\n[\n3592\n]:\nEAL\n:\nTSC\nfrequency\nis\n~\n2397202\nKHz\novs\n-\nvswitchd\n[\n3592\n]:\nEAL\n:\nMaster\nlcore\n0\nis\nready\n(\ntid\n=\nfc6cbb00\n;\ncpuset\n=\n[\n0\n])\novs\n-\nvswitchd\n[\n3592\n]:\nEAL\n:\nPCI\ndevice\n0000\n:\n04\n:\n00.0\non\nNUMA\nsocket\n0\novs\n-\nvswitchd\n[\n3592\n]:\nEAL\n:\nprobe\ndriver\n:\n8086\n:\n1528\nrte_ixgbe_pmd\novs\n-\nvswitchd\n[\n3592\n]:\nEAL\n:\nNot\nmanaged\nby\na\nsupported\nkernel\ndriver\n,\nskipped\novs\n-\nvswitchd\n[\n3592\n]:\nEAL\n:\nPCI\ndevice\n0000\n:\n04\n:\n00.1\non\nNUMA\nsocket\n0\novs\n-\nvswitchd\n[\n3592\n]:\nEAL\n:\nprobe\ndriver\n:\n8086\n:\n1528\nrte_ixgbe_pmd\novs\n-\nvswitchd\n[\n3592\n]:\nEAL\n:\nPCI\nmemory\nmapped\nat\n0x7f2140000000\novs\n-\nvswitchd\n[\n3592\n]:\nEAL\n:\nPCI\nmemory\nmapped\nat\n0x7f2140200000\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nMaster\nlcore\n0\nis\nready\n(\ntid\n=\nfc6cbb00\n;\ncpuset\n=\n[\n0\n])\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nPCI\ndevice\n0000\n:\n04\n:\n00.0\non\nNUMA\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nprobe\ndriver\n:\n8086\n:\n1528\nrte_ixgbe_pmd\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nNot\nmanaged\nby\na\nsupported\nkernel\ndriver\n,\nskipped\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nPCI\ndevice\n0000\n:\n04\n:\n00.1\non\nNUMA\nsocket\n0\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nprobe\ndriver\n:\n8086\n:\n1528\nrte_ixgbe_pmd\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nPCI\nmemory\nmapped\nat\n0x7f2140000000\novs\n-\nctl\n[\n3560\n]:\nEAL\n:\nPCI\nmemory\nmapped\nat\n0x7f2140200000\novs\n-\nvswitchd\n[\n3592\n]:\nPMD\n:\neth_ixgbe_dev_init\n():\nMAC\n:\n4\n,\nPHY\n:\n3\novs\n-\nvswitchd\n[\n3592\n]:\nPMD\n:\neth_ixgbe_dev_init\n():\nport\n0\nvendorID\n=\n0x8086\ndeviceID\n=\n0x1528\novs\n-\nctl\n[\n3560\n]:\nPMD\n:\neth_ixgbe_dev_init\n():\nMAC\n:\n4\n,\nPHY\n:\n3\novs\n-\nctl\n[\n3560\n]:\nPMD\n:\neth_ixgbe_dev_init\n():\nport\n0\nvendorID\n=\n0x8086\ndeviceID\n=\n0x1528\novs\n-\nctl\n[\n3560\n]:\nZone\n0\n:\nname\n:\n<\nRG_MP_log_history\n>\n,\nphys\n:\n0x83fffdec0\n,\nlen\n:\n0x2080\n,\nvirt\n:\n0x7f213fffdec0\n,\nsocket_id\n:\n0\n,\nflags\n:\n0\novs\n-\nctl\n[\n3560\n]:\nZone\n1\n:\nname\n:\n<\nMP_log_history\n>\n,\nphys\n:\n0x83fd73d40\n,\nlen\n:\n0x28a0c0\n,\nvirt\n:\n0x7f213fd73d40\n,\nsocket_id\n:\n0\n,\nflags\n:\n0\novs\n-\nctl\n[\n3560\n]:\nZone\n2\n:\nname\n:\n<\nrte_eth_dev_data\n>\n,\nphys\n:\n0x83fd43380\n,\nlen\n:\n0x2f700\n,\nvirt\n:\n0x7f213fd43380\n,\nsocket_id\n:\n0\n,\nflags\n:\n0\novs\n-\nctl\n[\n3560\n]:\n*\nStarting\novs\n-\nvswitchd\novs\n-\nctl\n[\n3560\n]:\n*\nEnabling\nremote\nOVSDB\nmanagers\nsystemd\n[\n1\n]:\nStarted\nOpen\nvSwitch\nInternal\nUnit\n.\nsystemd\n[\n1\n]:\nStarting\nOpen\nvSwitch\n...\nsystemd\n[\n1\n]:\nStarted\nOpen\nvSwitch\n.\nCMD\n:\nsudo\novs\n-\nvsctl\nadd\n-\nbr\novsdpdkbr0\n--\nset\nbridge\novsdpdkbr0\ndatapath_type\n=\nnetdev\nSYSLOG\n:\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.344\nZ\n|\n00008\n|\nmemory\n|\nINFO\n|\n37256\nkB\npeak\nresident\nset\nsize\nafter\n24.5\nseconds\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.346\nZ\n|\n00009\n|\nofproto_dpif\n|\nINFO\n|\nnetdev\n@ovs\n-\nnetdev\n:\nDatapath\nsupports\nrecirculation\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.346\nZ\n|\n00010\n|\nofproto_dpif\n|\nINFO\n|\nnetdev\n@ovs\n-\nnetdev\n:\nMPLS\nlabel\nstack\nlength\nprobed\nas\n3\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.346\nZ\n|\n00011\n|\nofproto_dpif\n|\nINFO\n|\nnetdev\n@ovs\n-\nnetdev\n:\nDatapath\nsupports\nunique\nflow\nids\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.346\nZ\n|\n00012\n|\nofproto_dpif\n|\nINFO\n|\nnetdev\n@ovs\n-\nnetdev\n:\nDatapath\ndoes\nnot\nsupport\nct_state\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.346\nZ\n|\n00013\n|\nofproto_dpif\n|\nINFO\n|\nnetdev\n@ovs\n-\nnetdev\n:\nDatapath\ndoes\nnot\nsupport\nct_zone\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.346\nZ\n|\n00014\n|\nofproto_dpif\n|\nINFO\n|\nnetdev\n@ovs\n-\nnetdev\n:\nDatapath\ndoes\nnot\nsupport\nct_mark\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.346\nZ\n|\n00015\n|\nofproto_dpif\n|\nINFO\n|\nnetdev\n@ovs\n-\nnetdev\n:\nDatapath\ndoes\nnot\nsupport\nct_label\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.360\nZ\n|\n00016\n|\nbridge\n|\nINFO\n|\nbridge\novsdpdkbr0\n:\nadded\ninterface\novsdpdkbr0\non\nport\n65534\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.361\nZ\n|\n00017\n|\nbridge\n|\nINFO\n|\nbridge\novsdpdkbr0\n:\nusing\ndatapath\nID\n00005\na4a1ed0a14d\n2016\n-\n01\n-\n22\nT08\n:\n58\n:\n56.361\nZ\n|\n00018\n|\nconnmgr\n|\nINFO\n|\novsdpdkbr0\n:\nadded\nservice\ncontroller\n\"punix:/var/run/openvswitch/ovsdpdkbr0.mgmt\"\nOVS\n-\nLOG\n:\novs\n-\nvsctl\n:\novs\n|\n00001\n|\nvsctl\n|\nINFO\n|\nCalled\nas\novs\n-\nvsctl\nadd\n-\nbr\novsdpdkbr0\n--\nset\nbridge\novsdpdkbr0\ndatapath_type\n=\nnetdev\nsystemd\n-\nudevd\n[\n3607\n]:\nCould\nnot\ngenerate\npersistent\nMAC\naddress\nfor\novs\n-\nnetdev\n:\nNo\nsuch\nfile\nor\ndirectory\nkernel\n:\n[\n50165.886554\n]\ndevice\novs\n-\nnetdev\nentered\npromiscuous\nmode\nkernel\n:\n[\n50165.901261\n]\ndevice\novsdpdkbr0\nentered\npromiscuous\nmode\nCMD\n:\nsudo\novs\n-\nvsctl\nadd\n-\nport\novsdpdkbr0\ndpdk0\n--\nset\nInterface\ndpdk0\ntype\n=\ndpdk\nSYSLOG\n:\n2016\n-\n01\n-\n22\nT08\n:\n59\n:\n06.369\nZ\n|\n00019\n|\nmemory\n|\nINFO\n|\npeak\nresident\nset\nsize\ngrew\n155\n%\nin\nlast\n10.0\nseconds\n,\nfrom\n37256\nkB\nto\n95008\nkB\n2016\n-\n01\n-\n22\nT08\n:\n59\n:\n06.369\nZ\n|\n00020\n|\nmemory\n|\nINFO\n|\nhandlers\n:\n4\nports\n:\n1\nrevalidators\n:\n2\nrules\n:\n5\n2016\n-\n01\n-\n22\nT08\n:\n59\n:\n30.989\nZ\n|\n00021\n|\ndpdk\n|\nINFO\n|\nPort\n0\n:\n8\nc\n:\ndc\n:\nd4\n:\nb3\n:\n6\nd\n:\ne9\n2016\n-\n01\n-\n22\nT08\n:\n59\n:\n31.520\nZ\n|\n00022\n|\ndpdk\n|\nINFO\n|\nPort\n0\n:\n8\nc\n:\ndc\n:\nd4\n:\nb3\n:\n6\nd\n:\ne9\n2016\n-\n01\n-\n22\nT08\n:\n59\n:\n31.521\nZ\n|\n00023\n|\ndpif_netdev\n|\nINFO\n|\nCreated\n1\npmd\nthreads\non\nnuma\nnode\n0\n2016\n-\n01\n-\n22\nT08\n:\n59\n:\n31.522\nZ\n|\n00001\n|\ndpif_netdev\n(\npmd16\n)\n|\nINFO\n|\nCore\n0\nprocessing\nport\n'dpdk0'\n2016\n-\n01\n-\n22\nT08\n:\n59\n:\n31.522\nZ\n|\n00024\n|\nbridge\n|\nINFO\n|\nbridge\novsdpdkbr0\n:\nadded\ninterface\ndpdk0\non\nport\n1\n2016\n-\n01\n-\n22\nT08\n:\n59\n:\n31.522\nZ\n|\n00025\n|\nbridge\n|\nINFO\n|\nbridge\novsdpdkbr0\n:\nusing\ndatapath\nID\n00008\ncdcd4b36de9\n2016\n-\n01\n-\n22\nT08\n:\n59\n:\n31.523\nZ\n|\n00002\n|\ndpif_netdev\n(\npmd16\n)\n|\nINFO\n|\nCore\n0\nprocessing\nport\n'dpdk0'\nOVS\n-\nLOG\n:\novs\n-\nvsctl\n:\novs\n|\n00001\n|\nvsctl\n|\nINFO\n|\nCalled\nas\novs\n-\nvsctl\nadd\n-\nport\novsdpdkbr0\ndpdk0\n--\nset\nInterface\ndpdk0\ntype\n=\ndpdk\novs\n-\nvswitchd\n[\n3595\n]:\nPMD\n:\nixgbe_dev_tx_queue_setup\n():\nsw_ring\n=\n0x7f211a79ebc0\nhw_ring\n=\n0x7f211a7a6c00\ndma_addr\n=\n0x81a7a6c00\novs\n-\nvswitchd\n[\n3595\n]:\nPMD\n:\nixgbe_set_tx_function\n():\nUsing\nsimple\ntx\ncode\npath\novs\n-\nvswitchd\n[\n3595\n]:\nPMD\n:\nixgbe_set_tx_function\n():\nVector\ntx\nenabled\n.\novs\n-\nvswitchd\n[\n3595\n]:\nPMD\n:\nixgbe_dev_rx_queue_setup\n():\nsw_ring\n=\n0x7f211a78a6c0\nsw_sc_ring\n=\n0x7f211a786580\nhw_ring\n=\n0x7f211a78e800\ndma_addr\n=\n0x81a78e800\novs\n-\nvswitchd\n[\n3595\n]:\nPMD\n:\nixgbe_set_rx_function\n():\nVector\nrx\nenabled\n,\nplease\nmake\nsure\nRX\nburst\nsize\nno\nless\nthan\n4\n(\nport\n=\n0\n)\n.\novs\n-\nvswitchd\n[\n3595\n]:\nPMD\n:\nixgbe_dev_tx_queue_setup\n():\nsw_ring\n=\n0x7f211a79ebc0\nhw_ring\n=\n0x7f211a7a6c00\ndma_addr\n=\n0x81a7a6c00\n...\nCMD\n:\nsudo\novs\n-\nvsctl\nadd\n-\nport\novsdpdkbr0\nvhost\n-\nuser\n-\n1\n--\nset\nInterface\nvhost\n-\nuser\n-\n1\ntype\n=\ndpdkvhostuser\nOVS\n-\nLOG\n:\n2016\n-\n01\n-\n22\nT09\n:\n00\n:\n35.145\nZ\n|\n00026\n|\ndpdk\n|\nINFO\n|\nSocket\n/\nvar\n/\nrun\n/\nopenvswitch\n/\nvhost\n-\nuser\n-\n1\ncreated\nfor\nvhost\n-\nuser\nport\nvhost\n-\nuser\n-\n1\n2016\n-\n01\n-\n22\nT09\n:\n00\n:\n35.145\nZ\n|\n00003\n|\ndpif_netdev\n(\npmd16\n)\n|\nINFO\n|\nCore\n0\nprocessing\nport\n'dpdk0'\n2016\n-\n01\n-\n22\nT09\n:\n00\n:\n35.145\nZ\n|\n00004\n|\ndpif_netdev\n(\npmd16\n)\n|\nINFO\n|\nCore\n0\nprocessing\nport\n'vhost-user-1'\n2016\n-\n01\n-\n22\nT09\n:\n00\n:\n35.145\nZ\n|\n00027\n|\nbridge\n|\nINFO\n|\nbridge\novsdpdkbr0\n:\nadded\ninterface\nvhost\n-\nuser\n-\n1\non\nport\n2\nSYSLOG\n:\novs\n-\nvsctl\n:\novs\n|\n00001\n|\nvsctl\n|\nINFO\n|\nCalled\nas\novs\n-\nvsctl\nadd\n-\nport\novsdpdkbr0\nvhost\n-\nuser\n-\n1\n--\nset\nInterface\nvhost\n-\nuser\n-\n1\ntype\n=\ndpdkvhostuser\novs\n-\nvswitchd\n[\n3595\n]:\nVHOST_CONFIG\n:\nsocket\ncreated\n,\nfd\n:\n46\novs\n-\nvswitchd\n[\n3595\n]:\nVHOST_CONFIG\n:\nbind\nto\n/\nvar\n/\nrun\n/\nopenvswitch\n/\nvhost\n-\nuser\n-\n1\nEventually\nwe\ncan\nsee\nthe\npoll\nthread\nin\ntop\nPID\nUSER\nPR\nNI\nVIRT\nRES\nSHR\nS\n%\nCPU\n%\nMEM\nTIME\n+\nCOMMAND\n3595\nroot\n10\n-\n10\n4975344\n103936\n9916\nS\n100.0\n0.3\n33\n:\n13.56\novs\n-\nvswitchd\nResources\n¶\nDPDK documentation\nRelease Notes matching the version packages in Ubuntu 16.04\nLinux DPDK user getting started\nEAL command-line options\nDPDK API documentation\nOpen Vswitch DPDK installation\nWikipedia’s definition of DPDK", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:20Z", "original_len_words": 3556}}
{"id": "0b9f44483a", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/ftp/", "title": "Set up an FTP server - Ubuntu Server documentation", "text": "Set up an FTP server - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nSet up an FTP server\n¶\nFile Transfer Protocol (FTP) is a TCP protocol for downloading files between computers. In the past, it has also been used for uploading but, as that method does not use encryption, user credentials as well as data transferred in the clear and are easily intercepted. So if you are here looking for a way to upload and download files securely, see the\nOpenSSH documentation\ninstead.\nFTP works on a client/server model. The server component is called an\nFTP daemon\n. It continuously listens for FTP requests from remote clients. When a request is received, it manages the login and sets up the connection. For the duration of the session it executes any of commands sent by the FTP client.\nAccess to an FTP server can be managed in two ways:\nAnonymous\nAuthenticated\nIn the Anonymous mode, remote clients can access the FTP server by using the default user account called “anonymous” or “ftp” and sending an email address as the password. In the Authenticated mode a user must have an account and a password. This latter choice is very insecure and should not be used except in special circumstances. If you are looking to transfer files securely see SFTP in the section on OpenSSH-Server. User access to the FTP server directories and files is dependent on the permissions defined for the account used at login. As a general rule, the FTP daemon will hide the root directory of the FTP server and change it to the FTP Home directory. This hides the rest of the file system from remote sessions.\nvsftpd - FTP Server Installation\n¶\nvsftpd is an FTP daemon available in Ubuntu. It is easy to install, set up, and maintain. To install vsftpd you can run the following command:\nsudo apt install vsftpd\nAnonymous FTP Configuration\n¶\nBy default vsftpd is\nnot\nconfigured to allow anonymous download. If you wish to enable anonymous download edit\n/etc/vsftpd.conf\nby changing:\nanonymous_enable=YES\nDuring installation a\nftp\nuser is created with a home directory of\n/srv/ftp\n. This is the default FTP directory.\nIf you wish to change this location, to\n/srv/files/ftp\nfor example, simply create a directory in another location and change the\nftp\nuser’s home directory:\nsudo mkdir -p /srv/files/ftp\nsudo usermod -d /srv/files/ftp ftp\nAfter making the change restart vsftpd:\nsudo systemctl restart vsftpd.service\nFinally, copy any files and directories you would like to make available through anonymous FTP to\n/srv/files/ftp\n, or\n/srv/ftp\nif you wish to use the default.\nUser Authenticated FTP Configuration\n¶\nBy default vsftpd is configured to authenticate system users and allow them to download files. If you want users to be able to upload files, edit\n/etc/vsftpd.conf\n:\nwrite_enable=YES\nNow restart vsftpd:\nsudo systemctl restart vsftpd.service\nNow when system users login to FTP they will start in their\nhome\ndirectories where they can download, upload, create directories, etc.\nSimilarly, by default, anonymous users are not allowed to upload files to FTP server. To change this setting, you should uncomment the following line, and restart vsftpd:\nanon_upload_enable=YES\nWarning\nEnabling anonymous FTP upload can be an extreme security risk. It is best to not enable anonymous upload on servers accessed directly from the Internet.\nThe configuration file consists of many configuration parameters. The information about each parameter is available in the configuration file. Alternatively, you can refer to the man page,\nman\n5\nvsftpd.conf\nfor details of each parameter.\nSecuring FTP\n¶\nThere are options in\n/etc/vsftpd.conf\nto help make vsftpd more secure. For example users can be limited to their home directories by uncommenting:\nchroot_local_user=YES\nYou can also limit a specific list of users to just their home directories:\nchroot_list_enable=YES\nchroot_list_file=/etc/vsftpd.chroot_list\nWarning\nIf chroot_local_user is set to YES (setting all users to be limited a to just their home directories), /etc/vsftpd.chroot_list becomes a list of users which are NOT limited a to just their home directories\nAfter uncommenting the above options, create a\n/etc/vsftpd.chroot_list\ncontaining a list of users one per line. Then restart vsftpd:\nsudo systemctl restart vsftpd.service\nAlso, the\n/etc/ftpusers\nfile is a list of users that are\ndisallowed\nFTP access. The default list includes root, daemon, nobody, etc. To disable FTP access for additional users simply add them to the list.\nFTP can also be encrypted using\nFTPS\n. Different from\nSFTP\n,\nFTPS\nis FTP over Secure Socket Layer (SSL).\nSFTP\nis a FTP like session over an encrypted\nSSH\nconnection. A major difference is that users of SFTP need to have a\nshell\naccount on the system, instead of a\nnologin\nshell. Providing all users with a shell may not be ideal for some environments, such as a shared web host. However, it is possible to restrict such accounts to only SFTP and disable shell interaction.\nTo configure\nFTPS\n, edit\n/etc/vsftpd.conf\nand at the bottom add:\nssl_enable=YES\nAlso, notice the certificate and key related options:\nrsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem\nrsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\nBy default these options are set to the certificate and key provided by the ssl-cert package. In a production environment these should be replaced with a certificate and key generated for the specific host. For more information on certificates see\nSecurity - Certificates\n.\nNow restart vsftpd, and non-anonymous users will be forced to use\nFTPS\n:\nsudo systemctl restart vsftpd.service\nTo allow users with a shell of\n/usr/sbin/nologin\naccess to FTP, but have no shell access, edit\n/etc/shells\nadding the\nnologin\nshell:\n# /etc/shells: valid login shells\n/bin/csh\n/bin/sh\n/usr/bin/es\n/usr/bin/ksh\n/bin/ksh\n/usr/bin/rc\n/usr/bin/tcsh\n/bin/tcsh\n/usr/bin/esh\n/bin/dash\n/bin/bash\n/bin/rbash\n/usr/bin/screen\n/usr/sbin/nologin\nThis is necessary because, by default vsftpd uses PAM for authentication, and the\n/etc/pam.d/vsftpd\nconfiguration file contains:\nauth    required        pam_shells.so\nThe\nshells\nPAM module restricts access to shells listed in the\n/etc/shells\nfile.\nMost popular FTP clients can be configured to connect using FTPS. The lftp command line FTP client has the ability to use FTPS as well.\nReferences\n¶\nSee the\nvsftpd website\nfor more information.", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:20Z", "original_len_words": 1020}}
{"id": "669d54db17", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/install-dns/", "title": "Domain Name Service (DNS) - Ubuntu Server documentation", "text": "Domain Name Service (DNS) - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nDomain Name Service (DNS)\n¶\nDomain Name Service (DNS) is an Internet service that maps IP addresses and\nfully qualified domain names (FQDN)\nto one another. In this way, DNS alleviates the need to remember IP addresses. Computers that run DNS are called\nname servers\n. Ubuntu ships with the Berkley Internet Naming Daemon (BIND), the most common program used for maintaining a name server on Linux.\nInstall DNS\n¶\nAt a terminal prompt, run the following command to install the\nbind9\npackage:\nsudo\napt\ninstall\nbind9\nA useful package for testing and troubleshooting DNS issues is the\ndnsutils\npackage. Very often these tools will be installed already, but to check and/or install\ndnsutils\nenter the following:\nsudo\napt\ninstall\ndnsutils\nDNS configuration overview\n¶\nThere are many ways to configure BIND9. Some of the most common configurations include a caching nameserver, primary server, and secondary server.\nWhen configured as a\ncaching nameserver\n, BIND9 will find the answer to name queries and remember the answer when the domain is queried again.\nAs a\nprimary server\n, BIND9 reads the data for a zone from a file on its host, and is authoritative for that zone.\nAs a\nsecondary server\n, BIND9 gets the zone data from another nameserver that is authoritative for the zone.\nConfiguration files\n¶\nThe DNS configuration files are stored in the\n/etc/bind\ndirectory. The primary configuration file is\n/etc/bind/named.conf\n, which in the layout provided by the package just includes these files:\n/etc/bind/named.conf.options\n: Global DNS options\n/etc/bind/named.conf.local\n: For your zones\n/etc/bind/named.conf.default-zones\n: Default zones such as localhost, its reverse, and the root hints\nThe root nameservers used to be described in the file\n/etc/bind/db.root\n. This is now provided instead by the\n/usr/share/dns/root.hints\nfile shipped with the\ndns-root-data\npackage, and is referenced in the\nnamed.conf.default-zones\nconfiguration file above.\nIt is possible to configure the same server to be a caching name server, primary, and secondary: it all depends on the zones it is serving. A server can be the Start of Authority (SOA) for one zone, while providing secondary service for another zone. All the while providing caching services for hosts on the local LAN.\nSet up a caching nameserver\n¶\nThe default configuration acts as a caching server. Simply uncomment and edit\n/etc/bind/named.conf.options\nto set the IP addresses of your ISP’s DNS servers:\nforwarders\n{\n1.2.3.4\n;\n5.6.7.8\n;\n};\nNote\nReplace\n1.2.3.4\nand\n5.6.7.8\nwith the IP addresses of actual nameservers.\nTo enable the new configuration, restart the DNS server. From a terminal prompt, run:\nsudo\nsystemctl\nrestart\nbind9.service\nSee the dig section\nfor information on testing a caching DNS server.\nSet up a primary server\n¶\nIn this section BIND9 will be configured as the primary server for the domain\nexample.com\n. You can replace\nexample.com\nwith your FQDN (Fully Qualified Domain Name).\nForward zone file\n¶\nTo add a DNS zone to BIND9, turning BIND9 into a primary server, first edit\n/etc/bind/named.conf.local\n:\nzone\n\"example.com\"\n{\ntype\nmaster\n;\nfile\n\"/etc/bind/db.example.com\"\n;\n};\nNote\nIf BIND will be receiving automatic updates to the file as with\nDDNS\n, then use\n/var/lib/bind/db.example.com\nrather than\n/etc/bind/db.example.com\nboth here and in the copy command below.\nNow use an existing zone file as a template to create the\n/etc/bind/db.example.com\nfile:\nsudo\ncp\n/etc/bind/db.local\n/etc/bind/db.example.com\nEdit the new zone file\n/etc/bind/db.example.com\nand change\nlocalhost.\nto the FQDN of your server, including the additional\n.\nat the end. Change\n127.0.0.1\nto the nameserver’s IP address and\nroot.localhost\nto a valid email address, but with a\n.\ninstead of the usual\n@\nsymbol, again including the\n.\nat the end. Change the comment to indicate the domain that this file is for.\nCreate an\nA record\nfor the base domain,\nexample.com\n. Also, create an\nA record\nfor\nns.example.com\n, the name server in this example:\n;\n; BIND data file for example.com\n;\n$TTL    604800\n@       IN      SOA     example.com. root.example.com. (\n                              2         ; Serial\n                         604800         ; Refresh\n                          86400         ; Retry\n                        2419200         ; Expire\n                         604800 )       ; Negative Cache TTL\n\n@       IN      NS      ns.example.com.\n@       IN      A       192.168.1.10\n@       IN      AAAA    ::1\nns      IN      A       192.168.1.10\nYou must increment the\nSerial\nNumber\nevery time you make changes to the zone file. If you make multiple changes before restarting BIND9, only increment\nSerial\nonce.\nNow, you can add DNS records to the bottom of the zone file. See\nCommon Record Types\nfor details.\nNote\nMany admins like to use the “last edited” date as the Serial of a zone, such as\n2020012100\nwhich is\nyyyymmddss\n(where\nss\nis the Serial Number)\nOnce you have made changes to the zone file, BIND9 needs to be restarted for the changes to take effect:\nsudo\nsystemctl\nrestart\nbind9.service\nReverse zone file\n¶\nNow that the zone is set up and resolving names to IP Addresses, a\nreverse zone\nneeds to be added to allow DNS to resolve an address to a name.\nEdit\n/etc/bind/named.conf.local\nand add the following:\nzone\n\"1.168.192.in-addr.arpa\"\n{\ntype\nmaster\n;\nfile\n\"/etc/bind/db.192\"\n;\n};\nNote\nReplace\n1.168.192\nwith the first three octets of whatever network you are using. Also, name the zone file\n/etc/bind/db.192\nappropriately. It should match the first octet of your network.\nNow create the\n/etc/bind/db.192\nfile:\nsudo\ncp\n/etc/bind/db.127\n/etc/bind/db.192\nNext edit\n/etc/bind/db.192\n, changing the same options as\n/etc/bind/db.example.com\n:\n;\n; BIND reverse data file for local 192.168.1.XXX net\n;\n$TTL    604800\n@       IN      SOA     ns.example.com. root.example.com. (\n                              2         ; Serial\n                         604800         ; Refresh\n                          86400         ; Retry\n                        2419200         ; Expire\n                         604800 )       ; Negative Cache TTL\n;\n@       IN      NS      ns.\n10      IN      PTR     ns.example.com.\nThe\nSerial\nNumber\nin the reverse zone needs to be incremented on each change as well. For each\nA record\nyou configure in\n/etc/bind/db.example.com\nthat is for a different address, you will need to create a\nPTR record\nin\n/etc/bind/db.192\n.\nAfter creating the reverse zone file restart BIND9:\nsudo\nsystemctl\nrestart\nbind9.service\nSet up a secondary server\n¶\nOnce a primary server has been configured, a\nsecondary server\nis highly recommended. This will maintain the availability of the domain if the primary becomes unavailable.\nFirst, on the primary server, the zone transfer needs to be allowed. Add the\nallow-transfer\noption to the example\nForward\nand\nReverse\nzone definitions in\n/etc/bind/named.conf.local\n:\nzone\n\"example.com\"\n{\ntype\nmaster\n;\nfile\n\"/etc/bind/db.example.com\"\n;\nallow\n-\ntransfer\n{\n192.168.1.11\n;\n};\n};\nzone\n\"1.168.192.in-addr.arpa\"\n{\ntype\nmaster\n;\nfile\n\"/etc/bind/db.192\"\n;\nallow\n-\ntransfer\n{\n192.168.1.11\n;\n};\n};\nNote\nReplace\n192.168.1.11\nwith the IP address of your secondary nameserver.\nRestart BIND9 on the primary server:\nsudo\nsystemctl\nrestart\nbind9.service\nNext, on the secondary server, install the\nbind9\npackage the same way as on the primary. Then edit the\n/etc/bind/named.conf.local\nand add the following declarations for the Forward and Reverse zones:\nzone\n\"example.com\"\n{\ntype\nsecondary\n;\nfile\n\"db.example.com\"\n;\nmasters\n{\n192.168.1.10\n;\n};\n};\nzone\n\"1.168.192.in-addr.arpa\"\n{\ntype\nsecondary\n;\nfile\n\"db.192\"\n;\nmasters\n{\n192.168.1.10\n;\n};\n};\nOnce again, replace\n192.168.1.10\nwith the IP address of your primary nameserver, then restart BIND9 on the secondary server:\nsudo\nsystemctl\nrestart\nbind9.service\nIn\n/var/log/syslog\nyou should see something similar to the following (some lines have been split to fit the format of this document):\nclient 192.168.1.10#39448: received notify for zone '1.168.192.in-addr.arpa'\nzone 1.168.192.in-addr.arpa/IN: Transfer started.\ntransfer of '100.18.172.in-addr.arpa/IN' from 192.168.1.10#53:\n connected using 192.168.1.11#37531\nzone 1.168.192.in-addr.arpa/IN: transferred serial 5\ntransfer of '100.18.172.in-addr.arpa/IN' from 192.168.1.10#53:\n Transfer completed: 1 messages, \n6 records, 212 bytes, 0.002 secs (106000 bytes/sec)\nzone 1.168.192.in-addr.arpa/IN: sending notifies (serial 5)\n    \nclient 192.168.1.10#20329: received notify for zone 'example.com'\nzone example.com/IN: Transfer started.\ntransfer of 'example.com/IN' from 192.168.1.10#53: connected using 192.168.1.11#38577\nzone example.com/IN: transferred serial 5\ntransfer of 'example.com/IN' from 192.168.1.10#53: Transfer completed: 1 messages, \n8 records, 225 bytes, 0.002 secs (112500 bytes/sec)\nNote\nA zone is only transferred if the\nSerial\nNumber\non the primary is larger than the one on the secondary. If you want to have your primary DNS notify other secondary DNS servers of zone changes, you can add\nalso-notify\n{\nipaddress;\n};\nto\n/etc/bind/named.conf.local\nas shown in the example below:\nzone\n\"example.com\"\n{\ntype\nmaster\n;\nfile\n\"/etc/bind/db.example.com\"\n;\nallow\n-\ntransfer\n{\n192.168.1.11\n;\n};\nalso\n-\nnotify\n{\n192.168.1.11\n;\n};\n};\nzone\n\"1.168.192.in-addr.arpa\"\n{\ntype\nmaster\n;\nfile\n\"/etc/bind/db.192\"\n;\nallow\n-\ntransfer\n{\n192.168.1.11\n;\n};\nalso\n-\nnotify\n{\n192.168.1.11\n;\n};\n};\nNote\nThe default directory for non-authoritative zone files is\n/var/cache/bind/\n. This directory is also configured in AppArmor to allow the named daemon to write to it. See this page for\nmore information on AppArmor\n.\nTesting your setup\n¶\nresolv.conf\n¶\nThe first step in testing BIND9 is to add the nameserver’s IP address to a\nhosts resolver\n. The Primary nameserver should be configured as well as another host to double check things. Refer to\nDNS client configuration\nfor details on adding nameserver addresses to your network clients. In the end your\nnameserver\nline in\n/etc/resolv.conf\nshould be pointing at\n127.0.0.53\nand you should have a\nsearch\nparameter for your domain. Something like this:\nnameserver  127.0.0.53\nsearch example.com\nTo check which DNS server your local resolver is using, run:\nresolvectl\nstatus\nNote\nYou should also add the IP address of the secondary nameserver to your client configuration in case the primary becomes unavailable.\ndig\n¶\nIf you installed the\ndnsutils\npackage you can test your setup using the DNS lookup utility\ndig\n:\nAfter installing BIND9 use\ndig\nagainst the loopback interface to make sure it is listening on port 53. From a terminal prompt:\ndig\n-x\n127\n.0.0.1\nYou should see lines similar to the following in the command output:\n;;\nQuery\ntime\n:\n1\nmsec\n;;\nSERVER\n:\n192.168.1.10\n#53(192.168.1.10)\nIf you have configured BIND9 as a caching nameserver, “dig” an outside domain to check the query time:\ndig\nubuntu.com\nNote the query time toward the end of the command output:\n;;\nQuery\ntime\n:\n49\nmsec\nAfter a second\ndig\nthere should be improvement:\n;;\nQuery\ntime\n:\n1\nmsec\nping\n¶\nNow let’s demonstrate how applications make use of DNS to resolve a host name, by using the\nping\nutility to send an ICMP echo request:\nping\nexample.com\nThis tests if the nameserver can resolve the name\nns.example.com\nto an IP address. The command output should resemble:\nPING\nns\n.\nexample\n.\ncom\n(\n192.168.1.10\n)\n56\n(\n84\n)\nbytes\nof\ndata\n.\n64\nbytes\nfrom\n192.168.1.10\n:\nicmp_seq\n=\n1\nttl\n=\n64\ntime\n=\n0.800\nms\n64\nbytes\nfrom\n192.168.1.10\n:\nicmp_seq\n=\n2\nttl\n=\n64\ntime\n=\n0.813\nms\nnamed-checkzone\n¶\nA great way to test your zone files is by using the\nnamed-checkzone\nutility installed with the\nbind9\npackage. This utility allows you to make sure the configuration is correct before restarting BIND9 and making the changes live.\nTo test our example forward zone file, enter the following from a command prompt:\nnamed-checkzone\nexample.com\n/etc/bind/db.example.com\nIf everything is configured correctly you should see output similar to:\nzone\nexample\n.\ncom\n/\nIN\n:\nloaded\nserial\n6\nOK\nSimilarly, to test the reverse zone file enter the following:\nnamed\n-\ncheckzone\n1.168.192\n.\nin\n-\naddr\n.\narpa\n/\netc\n/\nbind\n/\ndb\n.192\nThe output should be similar to:\nzone\n1.168.192\n.\nin\n-\naddr\n.\narpa\n/\nIN\n:\nloaded\nserial\n3\nOK\nNote\nThe Serial Number of your zone file will probably be different.\nQuick temporary query logging\n¶\nWith the\nrndc\ntool, you can quickly turn query logging on and off, without restarting the service or changing the configuration file.\nTo turn query logging on, run:\nsudo\nrndc\nquerylog\non\nLikewise, to turn it off, run:\nsudo\nrndc\nquerylog\noff\nThe logs will be sent to\nsyslog\nand will show up in\n/var/log/syslog\nby default:\nJan\n20\n19\n:\n40\n:\n50\nnew\n-\nn1\nnamed\n[\n816\n]:\nreceived\ncontrol\nchannel\ncommand\n'querylog on'\nJan\n20\n19\n:\n40\n:\n50\nnew\n-\nn1\nnamed\n[\n816\n]:\nquery\nlogging\nis\nnow\non\nJan\n20\n19\n:\n40\n:\n57\nnew\n-\nn1\nnamed\n[\n816\n]:\nclient\n@\n0x7f48ec101480\n192.168.1.10\n#36139 (ubuntu.com): query: ubuntu.com IN A +E(0)K (192.168.1.10)\nNote\nThe amount of logs generated by enabling\nquerylog\ncould be huge!\nLogging\n¶\nBIND9 has a wide variety of logging configuration options available, but the two main ones are\nchannel\nand\ncategory\n, which configure where logs go, and what information gets logged, respectively.\nIf no logging options are configured the default configuration is:\nlogging\n{\ncategory\ndefault\n{\ndefault_syslog\n;\ndefault_debug\n;\n};\ncategory\nunmatched\n{\nnull\n;\n};\n};\nLet’s instead configure BIND9 to send\ndebug\nmessages related to DNS queries to a separate file.\nWe need to configure a\nchannel\nto specify which file to send the messages to, and a\ncategory\n. In this example, the category will log all queries. Edit\n/etc/bind/named.conf.local\nand add the following:\nlogging\n{\nchannel\nquery\n.\nlog\n{\nfile\n\"/var/log/named/query.log\"\n;\nseverity\ndebug\n3\n;\n};\ncategory\nqueries\n{\nquery\n.\nlog\n;\n};\n};\nNote\nThe\ndebug\noption can be set from 1 to 3. If a level isn’t specified, level 1 is the default.\nSince the\nnamed daemon\nruns as the\nbind\nuser, the\n/var/log/named\ndirectory must be created and the ownership changed:\nsudo\nmkdir\n/var/log/named\nsudo\nchown\nbind:bind\n/var/log/named\nNow restart BIND9 for the changes to take effect:\nsudo\nsystemctl\nrestart\nbind9.service\nYou should see the file\n/var/log/named/query.log\nfill with query information. This is a simple example of the BIND9 logging options. For coverage of advanced options see the “Further Reading” section at the bottom of this page.\nCommon record types\n¶\nThis section covers some of the most common DNS record types.\nA\nrecord\nThis record maps an IP address to a\nhostname\n.\nwww\nIN\nA\n192.168.1.12\nCNAME\nrecord\nUsed to create an alias to an existing A record. You cannot create a\nCNAME\nrecord pointing to another\nCNAME\nrecord.\nweb\nIN\nCNAME\nwww\nMX\nrecord\nUsed to define where emails should be sent to. Must point to an\nA\nrecord, not a\nCNAME\n.\n@\nIN\nMX\n1\nmail\n.\nexample\n.\ncom\n.\nmail\nIN\nA\n192.168.1.13\nNS\nrecord\nUsed to define which servers serve copies of a zone. It must point to an\nA\nrecord, not a\nCNAME\n. This is where primary and secondary servers are defined.\n@\nIN\nNS\nns\n.\nexample\n.\ncom\n.\n@\nIN\nNS\nns2\n.\nexample\n.\ncom\n.\nns\nIN\nA\n192.168.1.10\nns2\nIN\nA\n192.168.1.11\nFurther reading\n¶\nInstalling DNS Security Extensions (DNSSEC)\nUpstream BIND9 Documentation\nDNS and BIND\nis a popular book now in its fifth edition. There is now also a\nDNS and BIND on IPv6\nbook.\nA great place to ask for BIND9 assistance, and get involved with the Ubuntu Server community, is the\n#ubuntu-server\nIRC channel on\nLibera Chat\n.", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:21Z", "original_len_words": 2517}}
{"id": "f8610465eb", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/install-dnssec/", "title": "Installing DNS Security Extensions (DNSSEC) - Ubuntu Server documentation", "text": "Installing DNS Security Extensions (DNSSEC) - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nInstalling DNS Security Extensions (DNSSEC)\n¶\nDNSSEC is a set of security extensions to\nDNS\nwhich allow DNS data to be verified for authenticity and integrity.\nThis guide will show you how to enable DNSSEC for an existing zone in your BIND9 DNS server deployment, by serving additional records like\nDS\n,\nDNSKEY\nor\nRRSIG\nfor signed zones.\nStarting point\n¶\nThe starting point for this how-to is an existing BIND9 DNS server deployed with an authoritative zone. For details on how to deploy BIND9 in this fashion, please see the\nDNS How-To\n. One key difference from that guide, however, is that we need the zone file to be in a directory where the server can write to, like\n/var/lib/bind\n, instead of\n/etc/bind\n.\nNevertheless, here is a quick set of steps to reach that state for an example domain called\nexample.internal\n.\nFirst, install the\nbind9\npackage:\nsudo apt install bind9 -y\nEdit\n/etc/bind/named.conf.local\nand add this\nzone\nblock:\nzone \"example.internal\" {\n    type master;\n    file \"/var/lib/bind/db.example.internal\";\n};\nCreate the file\n/var/lib/bind/db.example.internal\nwith these contents:\n$TTL 86400      ; 1 day\nexample.internal.       IN SOA  example.internal. root.example.internal. (\n                                1          ; serial\n                                43200      ; refresh (12 hours)\n                                900        ; retry (15 minutes)\n                                1814400    ; expire (3 weeks)\n                                7200       ; minimum (2 hours)\n                                )\nexample.internal.       IN  NS      ns.example.internal.\nns                      IN  A       192.168.1.10\nnoble                   IN  A       192.168.1.11\nRestart the service:\nsudo systemctl restart named\nCheck if the service can resolve the name\nnoble.example.internal\n:\n$ dig @127.0.0.1 +short noble.example.internal\n192.168.1.11\nEnabling DNSSEC\n¶\nEnabling DNSSEC for a zone involves multiple steps. Thankfully for us, the BIND9 DNS server takes care of all of them by default, automatically, leaving very little for us to do. Converting a zone in this way means at least generating new keys, and signing all the Resource Records of the zone. But that is only “day 1”: such a zone must be maintained properly. Keys must be rotated, expiration dates must be set, etc. The current versions of BIND9 take care of that with a DNSSEC policy, and of course there is a default one that can be used from the start.\nTo migrate our\nexample.internal\nzone to DNSSEC, we just need to add two lines to its definition in\n/etc/bind/named.conf.local\n, so that it looks like this:\nzone \"example.internal\" {\n    type master;\n    file \"/var/lib/bind/db.example.internal\";\n    dnssec-policy default;\n    inline-signing yes;\n};\nWhat was added:\ndnssec-policy\ndefault\n: Use the default DNSSEC policy. A DNSSEC policy includes settings for key rotation, default TTL, and many others.\ninline-signing\nyes\n: keep a separate file for the signed zone.\nAfter this change, there is no need to restart the service, but it needs to be told to reload its configuration. This can be done with the\nrndc\ntool:\nsudo rndc reconfig\nThe server will immediately notice the new configuration and start the process to sign the\nexample.internal\nzone. The journal logs will show the progress, and can be inspected with the command:\nsudo journalctl -u named.service -f\nThe logs will show something similar to this:\nnamed[3246]: zone example.internal/IN (unsigned): loaded serial 1\nnamed[3246]: zone example.internal/IN (signed): loaded serial 1\nnamed[3246]: zone example.internal/IN (signed): receive_secure_serial: unchanged\nnamed[3246]: zone example.internal/IN (signed): sending notifies (serial 1)\nnamed[3246]: zone example.internal/IN (signed): reconfiguring zone keys\nnamed[3246]: keymgr: DNSKEY example.internal/ECDSAP256SHA256/44911 (CSK) created for policy default\nnamed[3246]: Fetching example.internal/ECDSAP256SHA256/44911 (CSK) from key repository.\nnamed[3246]: DNSKEY example.internal/ECDSAP256SHA256/44911 (CSK) is now published\nnamed[3246]: DNSKEY example.internal/ECDSAP256SHA256/44911 (CSK) is now active\nnamed[3246]: zone example.internal/IN (signed): next key event: 23-Oct-2024 22:47:12.544\nnamed[3246]: any newly configured zones are now loaded\nnamed[3246]: running\nnamed[3246]: resolver priming query complete: success\nnamed[3246]: managed-keys-zone: Key 20326 for zone . is now trusted (acceptance timer complete)\nnamed[3246]: zone example.internal/IN (signed): sending notifies (serial 3)\nDepending on the zone size, signing all records can take longer.\nA few interesting events can be seen in the logs above:\nKeys were generated for the\nexample.internal\nzone.\nThe\nexample.internal\nzone became signed.\nA\nkey event\nwas scheduled. This is BIND9 also taking care of the maintenance tasks of the signed zone and its keys.\nSince the zone changed, its serial number was incremented (started as 1, now it’s 3).\nThe DNSSEC keys are kept in\n/var/cache/bind\n:\n-rw-r--r-- 1 bind bind  413 Oct 23 20:50 Kexample.internal.+013+48112.key\n-rw------- 1 bind bind  215 Oct 23 20:50 Kexample.internal.+013+48112.private\n-rw-r--r-- 1 bind bind  647 Oct 23 20:50 Kexample.internal.+013+48112.state\nThis is the bulk of the work. This zone is now signed, and maintained automatically by BIND9 using the\ndefault\nDNSSEC policy.\nVerification\n¶\nThe zone that was just signed is almost ready to serve DNSSEC. Let’s perform some verification steps.\nAs it is now, this zone\nexample.internal\nis “disconnected” from the parent zone. Its name was made up for this guide, but even if it represented a real domain, it would still be missing the connection to the parent zone. Remember that DNSSEC relies on the chain of trust, and the parent of our zone needs to be able to vouch for it.\nBefore taking that step, however, it’s important to verify if everything else is working. In particular, we would want to perform some DNSSEC queries, and perform validation. A good tool to perform this validation is\ndelv\n.\ndelv\nis similar to\ndig\n, but it will perform validation on the results using the same internal resolver and validator logic as the BIND9 server itself.\nSince our zone is disconnected, we need to tell\ndelv\nto use the public key created for the zone as a trusted anchor, and to not try to reach out to the root servers of the internet.\nFirst, copy the public zone key somewhere else so it can be edited. For example:\ncp /var/cache/bind/Kexample.internal.+013+48112.key /tmp/example.key\nThat file will have some comments at the top, and then have a line that starts with the zone name, like this (the full key was truncated below for brevity):\nexample.internal. 3600 IN DNSKEY 257 3 13 jkmS5hfyY3nSww....\nWe need to make some changes here:\nRemove the comment lines from the top.\nEdit that line and replace the\n3600\nIN\nDNSKEY\ntext with\nstatic-key\n.\nThe key material after the\n13\nnumber must be enclosed in double quotes (\n\"\n).\nThe line needs to end with a\n;\n.\nAnd finally the line needs to be inside a\ntrust-anchors\nblock.\nIn the end, the\n/tmp/example.key\nfile should look like this:\ntrust-anchors {\n    example.internal. static-key 257 3 13 \"jkmS5hfyY3nSww....\";\n};\nNow\ndelv\ncan be used to query the\nexample.internal\nzone and perform DNSSEC validation:\n$ delv @127.0.0.1 -a /tmp/example.key +root=example.internal noble.example.internal +multiline\n; fully validated\nnoble.example.internal. 86400 IN A 192.168.1.11\nnoble.example.internal. 86400 IN RRSIG A 13 3 86400 (\n                                20241106131533 20241023195023 48112 example.internal.\n                                5fL4apIwCD9kt4XbzzlLxMXY3mj8Li1WZu3qzlcBpERp\n                                lXPgLODbRrWyp7L81xEFnfhecKtEYv+6Y0Xa5iVRug== )\nThis output shows important DNSSEC attributes:\n;\nfully\nvalidated\n: The DNSSEC validation was completed successfully, and the presented data is authenticated.\nRRSIG\n: This is the signature Resource Record that accompanies the\nA\nrecord from the result.\nConnecting the dots: the parent zone\n¶\nIn order to complete the chain of trust, the parent zone needs to be able to vouch for the child zone we just signed. How this is exactly done varies, depending on who is the administrator of the parent zone. It could be as simple as just pasting the DS or DNSKEY records in a form.\nTypically what is needed is either a DS record, or a DNSKEY record. Here is how to produce them, ready to be sent to the parent.\nDS record format\n¶\nA DS record can be produced from the zone public key via the\ndnssec-dsfromkey\ntool. For example:\n$ dnssec-dsfromkey /var/cache/bind/Kexample.internal.+013+48112.key\nexample.internal. IN DS 48112 13 2 1212DE7DA534556F1E11898F2C7A66736D5107962A19A0BFE1C2A67D6841962A\nDNSKEY record format\n¶\nThe DNSKEY format doesn’t need tooling, and can be found directly in the zone’s public key file, after the lines that start with the comment delimiter\n;\n:\n$ cat /var/cache/bind/Kexample.internal.+013+48112.key\n; This is a key-signing key, keyid 48112, for example.internal.\n; Created: 20241023205023 (Wed Oct 23 20:50:23 2024)\n; Publish: 20241023205023 (Wed Oct 23 20:50:23 2024)\n; Activate: 20241023205023 (Wed Oct 23 20:50:23 2024)\n; SyncPublish: 20241024215523 (Thu Oct 24 21:55:23 2024)\nexample.internal. 3600 IN DNSKEY 257 3 13 jkmS5hfyY3nSww4tD9Fy5d+GGc3A/zR1CFUxmN8T2TKTkgGWp8dusllM 7TrIZTEg6wZxmMs754/ftoTA6jmM1g==\nTaking that line, the actual record to send to the parent zone just needs a little bit of tweaking so it looks like this:\nexample.internal. 3600 IN DNSKEY 257 3 13 (jkmS5hfyY3nSww4tD9Fy5d+GGc3A/zR1CFUxmN8T2TKTkgGWp8dusllM 7TrIZTEg6wZxmMs754/ftoTA6jmM1g==);\nFurther reading\n¶\nThe DNSSEC Guide from bind9\nEasy-Start Guide for Signing Authoritative Zones\nCreating a Custom DNSSEC Policy\nDetailed DNSSEC chapter from the bind9 documentation\ndelv(1)\nmanual page\nWorking with the parent zone", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:21Z", "original_len_words": 1454}}
{"id": "46090a1ae2", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/install-isc-dhcp-server/", "title": "How to install and configure isc-dhcp-server - Ubuntu Server documentation", "text": "How to install and configure isc-dhcp-server - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nHow to install and configure isc-dhcp-server\n¶\nNote\nAlthough Ubuntu still supports\nisc-dhcp-server\n, this software is\nno longer supported by its vendor\n. It has been replaced by\nKea\n.\nIn this guide we show how to install and configure\nisc-dhcp-server\n, which installs the dynamic host configuration protocol daemon,\nDHCPD\n. For\nisc-kea\ninstructions,\nrefer to this guide instead\n.\nInstall isc-dhcp-server\n¶\nAt a terminal prompt, enter the following command to install\nisc-dhcp-server\n:\nsudo\napt\ninstall\nisc-dhcp-server\nNote\nYou can find diagnostic messages from\ndhcpd\nin\nsyslog\n.\nConfigure isc-dhcp-server\n¶\nYou will probably need to change the default configuration by editing\n/etc/dhcp/dhcpd.conf\nto suit your needs and particular configuration.\nMost commonly, what you want to do is assign an IP address randomly. This can be done with\n/etc/dhcp/dhcpd.conf\nsettings as follows:\n# minimal sample /etc/dhcp/dhcpd.conf\ndefault-lease-time 600;\nmax-lease-time 7200;\n    \nsubnet 192.168.1.0 netmask 255.255.255.0 {\n range 192.168.1.150 192.168.1.200;\n option routers 192.168.1.254;\n option domain-name-servers 192.168.1.1, 192.168.1.2;\n option domain-name \"mydomain.example\";\n}\nThis will result in the DHCP server giving clients an IP address from the range\n192.168.1.150\n-\n192.168.1.200\n. It will lease an IP address for 600 seconds if the client doesn’t ask for a specific time frame. Otherwise the maximum (allowed) lease will be 7200 seconds. The server will also “advise” the client to use\n192.168.1.254\nas the default-gateway and\n192.168.1.1\nand\n192.168.1.2\nas its\nDNS\nservers.\nYou also may need to edit\n/etc/default/isc-dhcp-server\nto specify the interfaces\ndhcpd\nshould listen to.\nIn the example below,\neth4\nis used, but you should replace this with the appropriate interface for your system. The name of the network interface can vary depending on your setup. For instance, it could be\neth0\n,\nens33\n, or any other name depending on the device you’re using.\nINTERFACESv4\n=\n\"eth4\"\nAfter changing the config files you need to restart the\ndhcpd\nservice:\nsudo\nsystemctl\nrestart\nisc\n-\ndhcp\n-\nserver\n.\nservice\nFurther reading\n¶\nThe\nisc-dhcp-server Ubuntu Wiki\npage has more information.\nFor more\n/etc/dhcp/dhcpd.conf\noptions see the\ndhcpd.conf(5)\nmanual page\nISC dhcp-server", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:21Z", "original_len_words": 379}}
{"id": "c225444a89", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/install-isc-kea/", "title": "How to install and configure isc-kea - Ubuntu Server documentation", "text": "How to install and configure isc-kea - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nHow to install and configure isc-kea\n¶\nIn this guide we show how to install and configure\nisc-kea\nin Ubuntu 23.04\nor greater.\nKea\nis the\nDHCP\nserver developed by ISC to replace\nisc-dhcp\n. It is newer and designed for more modern network environments.\nFor\nisc-dhcp-server\ninstructions,\nrefer to this guide instead\n.\nInstall isc-kea\n¶\nAt a terminal prompt, enter the following command to install\nisc-kea\n:\nsudo\napt\ninstall\nkea\nThis will also install a few binary packages, including\nkea-dhcp4-server\n: The IPv4 DHCP server (the one we will configure in this guide).\nkea-dhcp6-server\n: The IPv6 DHCP server.\nkea-ctrl-agent\n: A REST API service for Kea.\nkea-dhcp-ddns-server\n: A Dynamic\nDNS\nservice to update DNS based on DHCP lease events.\nSince the\nkea-ctrl-agent\nservice has some administrative rights to the Kea\nservices, we need to ensure regular users are not allowed to use the API\nwithout permissions. Ubuntu does it by requiring user authentication to access\nthe\nkea-ctrl-agent\nAPI service (\nLP: #2007312 has more details on this\n).\nTherefore, the installation process described above will get a\ndebconf\n“high” priority prompt with 3 options:\nno action (default);\nconfigure with a random password; or\nconfigure with a given password.\nIf there is no password, the\nkea-ctrl-agent\nwill\nnot\nstart.\nThe password is expected to be in\n/etc/kea/kea-api-password\n, with ownership\nroot:_kea\nand permissions\n0640\n. To change it, run\ndpkg-reconfigure\nkea-ctrl-agent\n(which will present the same 3 options from above again), or just edit the file\nmanually.\nConfigure kea-dhcp4\n¶\nThe\nkea-dhcp4\nservice can be configured by editing\n/etc/kea/kea-dhcp4.conf\n.\nMost commonly, what you want to do is let Kea assign an IP address from a\npre-configured IP address pool. This can be done with settings as follows:\n{\n\"Dhcp4\"\n:\n{\n\"interfaces-config\"\n:\n{\n\"interfaces\"\n:\n[\n\"eth4\"\n]\n},\n\"control-socket\"\n:\n{\n\"socket-type\"\n:\n\"unix\"\n,\n\"socket-name\"\n:\n\"/run/kea/kea4-ctrl-socket\"\n},\n\"lease-database\"\n:\n{\n\"type\"\n:\n\"memfile\"\n,\n\"lfc-interval\"\n:\n3600\n},\n\"valid-lifetime\"\n:\n600\n,\n\"max-valid-lifetime\"\n:\n7200\n,\n\"subnet4\"\n:\n[{\n\"id\"\n:\n1\n,\n\"subnet\"\n:\n\"192.168.1.0/24\"\n,\n\"pools\"\n:\n[{\n\"pool\"\n:\n\"192.168.1.150 - 192.168.1.200\"\n}],\n\"option-data\"\n:\n[{\n\"name\"\n:\n\"routers\"\n,\n\"data\"\n:\n\"192.168.1.254\"\n},\n{\n\"name\"\n:\n\"domain-name-servers\"\n,\n\"data\"\n:\n\"192.168.1.1, 192.168.1.2\"\n},\n{\n\"name\"\n:\n\"domain-name\"\n,\n\"data\"\n:\n\"mydomain.example\"\n}\n]\n}]\n}\n}\nThis will result in the DHCP server listening on interface “eth4”, giving clients an IP address from the range\n192.168.1.150\n-\n192.168.1.200\n. It will lease an IP address for 600 seconds if the client doesn’t ask for a specific time frame. Otherwise the maximum (allowed) lease will be 7200 seconds. The server will also “advise” the client to use\n192.168.1.254\nas the default-gateway and\n192.168.1.1\nand\n192.168.1.2\nas its DNS servers.\nAfter changing the config file you can reload the server configuration through\nkea-shell\nwith the following command (considering you have the\nkea-ctrl-agent\nrunning as described above):\nkea-shell\n--host\n127\n.0.0.1\n--port\n8000\n--auth-user\nkea-api\n--auth-password\n$(\ncat\n/etc/kea/kea-api-password\n)\n--service\ndhcp4\nconfig-reload\nThen, press\nctrl\n-\nd\n. The server should respond with:\n[\n{\n\"result\"\n:\n0\n,\n\"text\"\n:\n\"Configuration successful.\"\n}\n]\nmeaning your configuration was received by the server.\nThe\nkea-dhcp4-server\nservice logs should contain an entry similar to:\nDHCP4_DYNAMIC_RECONFIGURATION_SUCCESS\ndynamic\nserver\nreconfiguration\nsucceeded\nwith\nfile\n:\n/\netc\n/\nkea\n/\nkea\n-\ndhcp4\n.\nconf\nsignaling that the server was successfully reconfigured.\nYou can read\nkea-dhcp4-server\nservice logs with\njournalctl\n:\njournalctl\n-u\nkea-dhcp4-server\nAlternatively, instead of reloading the DHCP4 server configuration through\nkea-shell\n,  you can restart the\nkea-dhcp4-service\nwith:\nsystemctl\nrestart\nkea-dhcp4-server\nFurther reading\n¶\nISC Kea Documentation", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:21Z", "original_len_words": 643}}
{"id": "c22008e6ef", "source_url": "https://documentation.ubuntu.com/server/how-to/networking/install-nfs/", "title": "Network File System (NFS) - Ubuntu Server documentation", "text": "Network File System (NFS) - Ubuntu Server documentation\nContents\nMenu\nExpand\nLight mode\nDark mode\nAuto light/dark, in light mode\nAuto light/dark, in dark mode\nSkip to content\nBack to top\nView this page\nNetwork File System (NFS)\n¶\nNFS allows a system to share directories and files with others over a network. By using NFS, users and programs can access files on remote systems almost as if they were local files.\nSome of the most notable benefits that NFS can provide are:\nLocal workstations use less disk space because commonly used data can be stored on a single machine and still remain accessible to others over the network.\nThere is no need for users to have separate home directories on every network machine. Home directories could be set up on the NFS server and made available throughout the network.\nStorage devices such as floppy disks, CDROM drives, and USB Thumb drives can be used by other machines on the network. This may reduce the number of removable media drives throughout the network.\nWarning\nIf you use\nNFS and authd\nat the same time, you must add a Kerberos configuration on both the client and the server. Otherwise, you will encounter permission issues due to mismatched user and group identifiers.\nFor details, see\nUsing authd with NFS\n.\nInstallation\n¶\nAt a terminal prompt enter the following command to install the NFS Server:\nsudo apt install nfs-kernel-server\nTo start the NFS server, you can run the following command at a terminal prompt:\nsudo systemctl start nfs-kernel-server.service\nConfiguration\n¶\nYou can configure the directories to be exported by adding them to the\n/etc/exports\nfile. For example:\n/srv     *(ro,sync,subtree_check)\n/home    *.hostname.com(rw,sync,no_subtree_check)\n/scratch *(rw,async,no_subtree_check,no_root_squash)\nMake sure any custom mount points you’re adding have been created (/srv and /home will already exist):\nsudo mkdir /scratch\nApply the new config via:\nsudo exportfs -a\nYou can replace * with one of the\nhostname\nformats. Make the hostname declaration as specific as possible so unwanted systems cannot access the NFS mount.  Be aware that\n*.hostname.com\nwill match\nfoo.hostname.com\nbut not\nfoo.bar.my-domain.com\n.\nThe\nsync\n/\nasync\noptions control whether changes are guaranteed to be committed to stable storage before replying to requests.\nasync\nthus gives a performance benefit but risks data loss or corruption.  Even though\nsync\nis the default, it’s worth setting since exportfs will issue a warning if it’s left unspecified.\nsubtree_check\nand\nno_subtree_check\nenables or disables a security verification that subdirectories a client attempts to mount for an exported\nfilesystem\nare ones they’re permitted to do so.  This verification step has some performance implications for some use cases, such as home directories with frequent file renames.  Read-only filesystems are more suitable to enable\nsubtree_check\non.  Like with sync, exportfs will warn if it’s left unspecified.\nThere are a number of optional settings for NFS mounts for tuning performance, tightening security, or providing conveniences.  These settings each have their own trade-offs so it is important to use them with care, only as needed for the particular use case.\nno_root_squash\n, for example, adds a convenience to allow root-owned files to be modified by any client system’s root user; in a multi-user environment where executables are allowed on a shared mount point, this could lead to security problems.\nNFS Client Configuration\n¶\nTo enable NFS support on a client system, enter the following command at the terminal prompt:\nsudo apt install nfs-common\nUse the mount command to mount a shared NFS directory from another machine, by typing a command line similar to the following at a terminal prompt:\nsudo mkdir /opt/example\nsudo mount example.hostname.com:/srv /opt/example\nWarning\nThe mount point directory\n/opt/example\nmust exist. There should be no files or subdirectories in the\n/opt/example\ndirectory, else they will become inaccessible until the nfs filesystem is unmounted.\nAn alternate way to mount an NFS share from another machine is to add a line to the\n/etc/fstab\nfile. The line must state the hostname of the NFS server, the directory on the server being exported, and the directory on the local machine where the NFS share is to be mounted.\nThe general syntax for the line in\n/etc/fstab\nfile is as follows:\nexample.hostname.com:/srv /opt/example nfs rsize=8192,wsize=8192,timeo=14,intr\nAdvanced Configuration\n¶\nNFS is comprised of several services, both on the server and the client. Each one of these services can have its own default configuration, and depending on the Ubuntu Server release you have installed, this configuration is done in different files, and with a different syntax.\nUbuntu Server 22.04 LTS (“jammy”)\n¶\nAll NFS related services read a single configuration file:\n/etc/nfs.conf\n. This is a INI-style config file, see the\nnfs.conf(5)\nmanual page for details. Furthermore, there is a\n/etc/nfs.conf.d\ndirectory which can hold\n*.conf\nsnippets that can override settings from previous snippets or from the\nnfs.conf\nmain config file itself.\nThere is a new command-line tool called\nnfsconf(8)\nwhich can be used to query or even set configuration parameters in\nnfs.conf\n. In particular, it has a\n--dump\nparameter which will show the effective configuration including all changes done by\n/etc/nfs.conf.d/*.conf\nsnippets.\nFor Ubuntu Server 20.04 LTS (“focal”) and earlier\n¶\nEarlier Ubuntu releases use the traditional configuration mechanism for the NFS services via\n/etc/defaults/\nconfiguration files. These are\n/etc/default/nfs-common\nand\n/etc/default/nfs/kernel-server\n, and are used basically to adjust the command-line options given to each daemon.\nEach file has a small explanation about the available settings.\nWarning\nThe\nNEED_*\nparameters have no effect on systemd-based installations, like Ubuntu 20.04 LTS (“focal”) and Ubuntu 18.04 LTS (“bionic”).\nIn those systems, to control whether a service should be running or not, use\nsystemctl\nenable\nor\nsystemctl\ndisable\n, respectively.\nUpgrading to Ubuntu 22.04 LTS (“jammy”)\n¶\nThe main change to the NFS packages in Ubuntu 22.04 LTS (“jammy”) is the configuration file. Instead of multiple files sourced by startup scripts from\n/etc/default/nfs-*\n, now there is one main configuration file in\n/etc/nfs.conf\n, with an INI-style syntax.\nWhen upgrading to Ubuntu 22.04 LTS (“jammy”) from a release that still uses the\n/etc/defaults/nfs-*\nconfiguration files, the following will happen:\na default\n/etc/nfs.conf\nconfiguration file will be installed\nif the\n/etc/default/nfs-*\nfiles have been modified, a conversion script will be run and it will create\n/etc/nfs.conf.d/local.conf\nwith the local modifications.\nIf this conversion script fails, then the package installation will fail. This can happen if the\n/etc/default/nfs-*\nfiles have an option that the conversion script wasn’t prepared to handle, or a syntax error for example. In such cases, please file a bug using this link:\nhttps://bugs.launchpad.net/ubuntu/+source/nfs-utils/+filebug\nYou can run the conversion tool manually to gather more information about the error: it’s in\n/usr/share/nfs-common/nfsconvert.py\nand must be run as\nroot\n.\nIf all goes well, as it should in most cases, the system will have\n/etc/nfs.conf\nwith the defaults, and\n/etc/nfs.conf.d/local.conf\nwith the changes. You can merge these two together manually, and then delete\nlocal.conf\n, or leave it as is. Just keep in mind that\n/etc/nfs.conf\nis not the whole story: always inspect\n/etc/nfs.conf.d\nas well, as it may contain files overriding the defaults.\nYou can always run\nnfsconf\n--dump\nto check the final settings, as it merges together all configuration files and shows the resulting non-default settings.\nRestarting NFS services\n¶\nSince NFS is comprised of several individual services, it can be difficult to determine what to restart after a certain configuration change.\nThe tables below summarize all available services, which “meta” service they are linked to, and which configuration file each service uses.\nService\nnfs-utils.service\nnfs-server.service\nconfig file (22.04)\nconfig file (< 22.04) /etc/default/nfs-*\nnfs-blkmap\nPartOf\nnfs.conf\nnfs-mountd\nBindsTo\nnfs.conf\nnfs-kernel-server\nnfsdcld\nnfs-idmapd\nBindsTo\nnfs.conf, idmapd.conf\nidmapd.conf\nrpc-gssd\nPartOf\nnfs.conf\nrpc-statd\nPartOf\nnfs.conf\nnfs-common\nrpc-svcgssd\nPartOf\nBindsTo\nnfs.conf\nnfs-kernel-server\nFor example,\nsystemctl\nrestart\nnfs-server.service\nwill restart\nnfs-mountd\n,\nnfs-idmapd\nand\nrpc-svcgssd\n(if running). On the other hand, restarting\nnfs-utils.service\nwill restart\nnfs-blkmap\n,\nrpc-gssd\n,\nrpc-statd\nand\nrpc-svcgssd\n.\nOf course, each service can still be individually restarted with the usual\nsystemctl\nrestart\n<service>\n.\nThe\nnfs.systemd(7)\nmanpage has more details on the several systemd units available with the NFS packages.\nNFS with Kerberos\n¶\nKerberos with NFS adds an extra layer of security on top of NFS. It can be just a stronger authentication mechanism, or it can also be used to sign and encrypt the NFS traffic.\nThis section will assume you already have setup a Kerberos server, with a running KDC and admin services. Setting that up is explained elsewhere in the Ubuntu Server Guide.\nNFS server (using kerberos)\n¶\nThe NFS server will have the usual\nnfs-kernel-server\npackage and its dependencies, but we will also have to install kerberos packages. The kerberos packages are not strictly necessary, as the necessary keys can be copied over from the KDC, but it makes things much easier.\nFor this example, we will use:\n.vms\nDNS\ndomain\nVMS\nKerberos realm\nj-nfs-server.vms\nfor the NFS server\nj-nfs-client.vms\nfor the NFS client\nubuntu/admin\nprincipal has admin privileges on the KDC\nAdjust these names according to your setup.\nFirst, install the\nkrb5-user\npackage:\nsudo apt install krb5-user\nThen, with an admin principal, let’s create a key for the NFS server:\n$ sudo kadmin -p ubuntu/admin -q \"addprinc -randkey nfs/j-nfs-server.vms\"\nAnd extract the key into the local keytab:\n$ sudo kadmin -p ubuntu/admin -q \"ktadd nfs/j-nfs-server.vms\"\nAuthenticating as principal ubuntu/admin with password.\nPassword for ubuntu/admin@VMS:\nEntry for principal nfs/j-nfs-server.vms with kvno 2, encryption type aes256-cts-hmac-sha1-96 added to keytab FILE:/etc/krb5.keytab.\nEntry for principal nfs/j-nfs-server.vms with kvno 2, encryption type aes128-cts-hmac-sha1-96 added to keytab FILE:/etc/krb5.keytab.\nConfirm the key is available:\n$ sudo klist -k\nKeytab name: FILE:/etc/krb5.keytab\nKVNO Principal\n---- --------------------------------------------------------------------------\n   2 nfs/j-nfs-server.vms@VMS\n   2 nfs/j-nfs-server.vms@VMS\nNow install the NFS server:\n$ sudo apt install nfs-kernel-server\nThis will already automatically start the kerberos-related nfs services, because of the presence of\n/etc/krb5.keytab\n.\nNow populate\n/etc/exports\n, restricting the exports to krb5 authentication. For example, exporting\n/storage\nusing\nkrb5p\n:\n/storage *(rw,sync,no_subtree_check,sec=krb5p)\nRefresh the exports:\n$ sudo exportfs -rav\nexporting *:/storage\nThe security options are explained in the\nexports(5)\nmanpage, but generally they are:\nkrb5\n: use kerberos for authentication only (non-auth traffic is in clear text)\nkrb5i\n: use kerberos for authentication and integrity checks (non-auth traffic is in clear text)\nkrb5p\n: use kerberos for authentication, integrity and privacy protection (non-auth traffic is encrypted)\nNFS client (using kerberos)\n¶\nThe NFS client has a similar set of steps. First we will prepare the client’s keytab, so that when we install the NFS client package it will start the extra kerberos services automatically just by detecting the presence of the keytab:\nsudo apt install krb5-user\nTo allow the\nroot\nuser to mount NFS shares via kerberos without a password, we have to create a host key for the NFS client:\nsudo kadmin -p ubuntu/admin -q \"addprinc -randkey host/j-nfs-client.vms\"\nAnd extract it:\n$ sudo kadmin -p ubuntu/admin -q \"ktadd host/j-nfs-client.vms\"\nNow install the NFS client package:\n$ sudo apt install nfs-common\nAnd you should be able to do your first NFS kerberos mount:\n$ sudo mount j-nfs-server:/storage /mnt\nIf you are using a machine credential, then the above mount will work without having a kerberos ticket, i.e.,\nklist\nwill show no tickets:\n# mount j-nfs-server:/storage /mnt\n# ls -l /mnt/*\n-rw-r--r-- 1 root root 0 Apr  5 14:50 /mnt/hello-from-nfs-server.txt\n# klist\nklist: No credentials cache found (filename: /tmp/krb5cc_0)\nNotice the above was done with\nroot\n. Let’s try accessing that existing mount with the\nubuntu\nuser, without acquiring a kerberos ticket:\n# sudo -u ubuntu -i\n$ ls -l /mnt/*\nls: cannot access '/mnt/*': Permission denied\nThe\nubuntu\nuser will only be able to access that mount if they have a kerberos ticket:\n$ kinit\nPassword for ubuntu@VMS: \n$ ls -l /mnt/*\n-rw-r--r-- 1 root root 0 Apr  5 14:50 /mnt/hello-from-nfs-server.txt\nAnd now we have not only the TGT, but also a ticket for the NFS service:\n$ klist\nTicket cache: FILE:/tmp/krb5cc_1000\nDefault principal: ubuntu@VMS\n\nValid starting     Expires            Service principal\n04/05/22 17:48:50  04/06/22 03:48:50  krbtgt/VMS@VMS\n        renew until 04/06/22 17:48:48\n04/05/22 17:48:52  04/06/22 03:48:50  nfs/j-nfs-server.vms@\n        renew until 04/06/22 17:48:48\n        Ticket server: nfs/j-nfs-server.vms@VMS\nOne drawback of using a machine credential for mounts done by the\nroot\nuser is that you need a persistent secret (the\n/etc/krb5.keytab\nfile) in the filesystem. Some sites may not allow such a persistent secret to be stored in the filesystem. An alternative is to use\nrpc.gssd\ns\n-n\noption. From\nrpc.gssd(8)\n:\n-n\n: when specified, UID 0 is forced to obtain user credentials which are used instead of the local system’s machine credentials.\nWhen this option is enabled and\nrpc.gssd\nrestarted, then even the\nroot\nuser will need to obtain a kerberos ticket to perform an NFS kerberos mount.\nWarning\nNote that this prevents automatic NFS mounts via\n/etc/fstab\n, unless a kerberos ticket is obtained before.\nIn Ubuntu 22.04 LTS (“jammy”), this option is controlled in\n/etc/nfs.conf\nin the\n[gssd]\nsection:\n[gssd]\nuse-machine-creds=0\nIn older Ubuntu releases, the command line options for the\nrpc.gssd\ndaemon are not exposed in\n/etc/default/nfs-common\n, therefore a systemd override file needs to be created. You can either run:\n$ sudo systemctl edit rpc-gssd.service\nAnd paste the following into the editor that will open:\n[Service]\nExecStart=\nExecStart=/usr/sbin/rpc.gssd $GSSDARGS -n\nOr manually create the file\n/etc/systemd/system/rpc-gssd.service.d/override.conf\nand any needed directories up to it, with the contents above.\nAfter you restart the service with\nsystemctl\nrestart\nrpc-gssd.service\n, the\nroot\nuser won’t be able to mount the NFS kerberos share without obtaining a ticket first.\nReferences\n¶\nLinux NFS wiki\nLinux NFS faq\nUbuntu Wiki NFS Howto\nUbuntu Wiki NFSv4 Howto", "meta": {"site": "documentation.ubuntu.com", "crawl_ts": "2025-11-27T10:38:22Z", "original_len_words": 2252}}
